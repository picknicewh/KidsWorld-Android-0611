function setWebViewFlag(){isWebviewFlag=!0}function loadURL(url){var iFrame;iFrame=document.createElement("iframe"),iFrame.setAttribute("src",url),iFrame.setAttribute("style","display:none;"),iFrame.setAttribute("height","0px"),iFrame.setAttribute("width","0px"),iFrame.setAttribute("frameborder","0"),document.body.appendChild(iFrame),iFrame.parentNode.removeChild(iFrame),iFrame=null}function exec(funName,args){var commend={functionName:funName,arguments:args},jsonStr=JSON.stringify(commend),url="umeng:"+jsonStr;loadURL(url)}var isWebviewFlag,MobclickAgent={getDeviceId:function(callBack){isWebviewFlag&&exec("getDeviceId",[callBack.name])},onCCEvent:function(evenArray,evenValue,eventLabel){isWebviewFlag&&exec("onCCEvent",[evenArray,evenValue,eventLabel])},onEvent:function(eventId){isWebviewFlag&&exec("onEvent",[eventId])},onEventWithLabel:function(eventId,eventLabel){isWebviewFlag&&exec("onEventWithLabel",[eventId,eventLabel])},onEventWithParameters:function(eventId,eventData){isWebviewFlag&&exec("onEventWithParameters",[eventId,eventData])},onEventWithCounter:function(eventId,eventData,eventNum){isWebviewFlag&&exec("onEventWithCounter",[eventId,eventData,eventNum])},onPageBegin:function(pageName){isWebviewFlag&&exec("onPageBegin",[pageName])},onPageEnd:function(pageName){isWebviewFlag&&exec("onPageEnd",[pageName])},profileSignInWithPUID:function(UID){isWebviewFlag&&exec("profileSignInWithPUID",[UID])},profileSignInWithPUIDWithProvider:function(provider,UID){isWebviewFlag&&exec("profileSignInWithPUIDWithProvider",[provider,UID])},profileSignOff:function(){isWebviewFlag&&exec("profileSignOff",[])},setUserLevelId:function(level){isWebviewFlag&&exec("setUserLevelId",[level])},startLevel:function(level){isWebviewFlag&&exec("startLevel",[level])},finishLevel:function(level){isWebviewFlag&&exec("finishLevel",[level])},failLevel:function(level){isWebviewFlag&&exec("failLevel",[level])},exchange:function(currencyAmount,currencyType,virtualAmount,channel,orderId){isWebviewFlag&&exec("exchange",[currencyAmount,currencyType,virtualAmount,channel,orderId])},pay:function(money,coin,source){isWebviewFlag&&exec("pay",[money,coin,source])},payWithItem:function(money,item,number,price,source){isWebviewFlag&&exec("payWithItem",[money,item,number,price,source])},buy:function(item,number,price){isWebviewFlag&&exec("buy",[item,number,price])},use:function(item,number,price){isWebviewFlag&&exec("use",[item,number,price])},bonusWithItem:function(item,number,price,source){isWebviewFlag&&exec("bonusWithItem",[item,number,price,source])},bonus:function(coin,source){isWebviewFlag&&exec("bonus",[coin,source])}};angular.module("app.constants",[]).constant("BASE_URL","https://eduslb.openhunme.com/KidsWorld"),angular.module("app.directives",[]),angular.module("app.filters",[]),angular.module("app.filters").filter("numberTo4",function(){return function(input){if(input){if(input>=1e3){var newNum=(input/1e4).toFixed(1);return newNum+"万"}return input}return 0}}),angular.module("app.filters").filter("timeToMinute",function(){return function(inputs){return inputs?inputs.substring(5,16):""}}),angular.module("app.services",[]),angular.module("app.services").factory("AjaxService",function($http,$httpParamSerializerJQLike,$q,$ionicLoading,CommonService,BASE_URL,$rootScope){return{ajax:function(options){var url=options.url;options.useBaseUrl&&(url=BASE_URL+options.url);var httpOption={method:options.type||"post",url:url};if("post"==httpOption.method)httpOption.data=options.data||{};else{var pString=$httpParamSerializerJQLike(options.data||{});httpOption.url+=pString?"?"+pString:""}var deferred=$q.defer();return"post"==httpOption.method?$.ajax({type:"post",url:httpOption.url,data:httpOption.data,dataType:"json",success:function(data){return data.code==-9?void CommonService.showAlert.show("系统繁忙"):void deferred.resolve({data:data})},error:function(data){CommonService.showAlert.show("网络异常"),$rootScope.$broadcast("ajaxError"),deferred.reject(data)}}):$http(httpOption).success(function(data,status,header,config){return data.code==-9?void CommonService.showAlert.show("系统繁忙"):void deferred.resolve({data:data})}).error(function(data,status,header,config){CommonService.showAlert.show("网络异常"),$rootScope.$broadcast("ajaxError"),deferred.reject(data)}),{$promise:deferred.promise}}}}),angular.module("app.services").factory("WebService",function(AjaxService){return{getContentInfo:function(tsId,themeid){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getContentInfo.do",options.data={tsId:tsId,themeid:themeid},AjaxService.ajax(options)},subPraise:function(tsId,resourceid,cancel){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/subPraise.do",options.data={tsId:tsId,resourceid:resourceid,cancel:cancel},AjaxService.ajax(options)},getResourceDetail:function(tsId,resourceid){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getDetails.do",options.data={tsId:tsId,resourceId:resourceid,account_id:accountIdLogin},AjaxService.ajax(options)},subComment:function(resourceid,tsId,content){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/subComment",options.data={resourceid:resourceid,tsId:tsId,content:content},AjaxService.ajax(options)},getCommentList:function(resourceid,pageSize,pageNumber){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getCommentList.do",options.data={resourceid:resourceid,pageSize:pageSize,pageNumber:pageNumber},AjaxService.ajax(options)},getTsInfo:function(tsId){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/message/getTS.do",options.data={tsId:tsId},AjaxService.ajax(options)},newGetBanner:function(tsId){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/newGetBanner.do",options.data={tsId:tsId},AjaxService.ajax(options)},guessYouLike:function(tsId,type,pageNumber,pageSize){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getRecommendAblum.do",options.data={tsId:tsId,type:type,pageNumber:pageNumber,pageSize:pageSize},AjaxService.ajax(options)},getInformation:function(tsId,type,pageNumber,pageSize,themeId){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getInformation.do",options.data={tsId:tsId,type:type,pageNumber:pageNumber,pageSize:pageSize,themeId:themeId,account_id:accountIdLogin},AjaxService.ajax(options)},savePlayTheRecordingBegin:function(tsId,resourceid){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/savePlayTheRecording.do",options.data={tsId:tsId,resourceid:resourceid,type:1},AjaxService.ajax(options)},savePlayTheRecordingProgress:function(tsId,resourceid,broadcastPace){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/savePlayTheRecording.do",options.data={tsId:tsId,resourceid:resourceid,type:2,broadcastPace:broadcastPace},AjaxService.ajax(options)},getThemeList:function(tsId,type){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getThemeList.do",options.data={tsId:tsId,type:type,pageNumber:1,pageSize:100},AjaxService.ajax(options)},getAlbumByTheme:function(tsId,themeId,pageNumber,pageSize){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getAlbumByTheme.do",options.data={tsId:tsId,themeId:themeId,pageNumber:pageNumber,pageSize:pageSize},AjaxService.ajax(options)},resourceSearch:function(tsId,tag,type,pageSize,pageNumber){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/resourceSearch.do",options.data={tsId:tsId,tag:tag,type:type,pageSize:pageSize,pageNumber:pageNumber,account_id:accountIdLogin},AjaxService.ajax(options)},saveResourceFavorites:function(tsId,albumId,type){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/saveResourceFavorites.do",options.data={tsId:tsId,albumId:albumId,type:type},AjaxService.ajax(options)},getCompilationsAllResource:function(tsId,albumId){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getCompilationsAllResource.do",options.data={tsId:tsId,albumId:albumId,pageSize:1e3,pageNumber:1,account_id:accountIdLogin},AjaxService.ajax(options)}}}),angular.module("app.services").factory("CommonService",function(){function addSearchHisItemByKey(key,item){var history=store.get(key);if(history){$.each(history,function(ind,el){if(el.searchHis==item)return history.splice(ind,1),!1});var length=history.length;length<10?history.unshift({searchHis:item}):length>=10&&(history.splice(length-1,1),history.unshift({searchHis:item}))}else history=[{searchHis:item}];store.set(key,history)}return{showAlert:{cfg:{id:".kBubble",speed:2e3},show:function(str){var oBubble=$(this.cfg.id);oBubble.length||(oBubble=$('<div class="kBubble" />').appendTo($("body")),oBubble.html(str).fadeIn()),setTimeout("$('.kBubble').fadeOut('slow',function(){$('.kBubble').remove();})",this.cfg.speed)}},searchHisService:{addGeneralHis:function(item){addSearchHisItemByKey("generalSearchHistory",item)},getGeneralHis:function(){return store.get("generalSearchHistory")},addAudioHis:function(item){addSearchHisItemByKey("audioSearchHistory",item)},getAudioHis:function(){return store.get("audioSearchHistory")},addVideoHis:function(item){addSearchHisItemByKey("videoSearchHistory",item)},getVideoHis:function(){return store.get("videoSearchHistory")},addInfHis:function(item){addSearchHisItemByKey("infSearchHistory",item)},getInfHis:function(){return store.get("infSearchHistory")}}}}),angular.module("app",["ui.router","ngAnimate","ionic","app.services","app.controllers","app.constants","app.directives","app.filters"]).run(function($rootScope,$state){function onDeviceReady(){}$rootScope.$on("$stateChangeStart",function(event,next){}),document.addEventListener("deviceready",onDeviceReady,!1)}).config(function($stateProvider,$urlRouterProvider,$ionicConfigProvider){$ionicConfigProvider.views.maxCache(1),$stateProvider.state("paradiseHome",{url:"/paradiseHome",templateUrl:"views/paradiseHome.html",controller:"ParadiseHomeCtrl"}).state("search",{url:"/search",templateUrl:"views/search.html",controller:"SearchCtrl"}).state("search_Audio",{url:"/search_Audio",templateUrl:"views/search_Audio.html",controller:"Search_AudioCtrl"}).state("search_Video",{url:"/search_Video",templateUrl:"views/search_Video.html",controller:"Search_VideoCtrl"}).state("search_Inf",{url:"/search_Inf",templateUrl:"views/search_Inf.html",controller:"Search_InfCtrl"}).state("childClass",{url:"/childClass",templateUrl:"views/childClass.html",controller:"ChildClassCtrl"}).state("childClass_Sort",{url:"/childClass_Sort?typeid&typename",templateUrl:"views/childClass_Sort.html",controller:"ChildClass_SortCtrl"}).state("childMusic",{url:"/childMusic",templateUrl:"views/childMusic.html",controller:"ChildMusicCtrl"}).state("childMusic_Sort",{url:"/childMusic_Sort?typeid&typename",templateUrl:"views/childMusic_Sort.html",controller:"ChildMusic_SortCtrl"}).state("eduInformation",{url:"/eduInformation",templateUrl:"views/eduInformation.html",controller:"EduInformationCtrl"}).state("videoPlay",{url:"/videoPlay?themeid&resourceid&broadcastPace",templateUrl:"views/videoPlay.html",controller:"VideoPlayCtrl"}).state("eduInformation_Detail",{url:"/eduInformation_Detail?resourceid",templateUrl:"views/eduInformation_Detail.html",controller:"EduInformation_DetailCtrl"}),$urlRouterProvider.otherwise("paradiseHome")}),angular.module("app.controllers",[]),angular.module("app.controllers").controller("ParadiseHomeCtrl",function($scope,$rootScope,$ionicLoading,$ionicSlideBoxDelegate,$state,$ionicPopup,WebService,CommonService){var tempResource=[{imgUrl:"images/icon/default_16_9.png",name:"."},{imgUrl:"images/icon/default_16_9.png",name:"."},{imgUrl:"images/icon/default_16_9.png",name:"."},{imgUrl:"images/icon/default_16_9.png",name:"."}];$scope.items_eduInf=store.get("infFrontHis")||tempResource,$scope.items_audio=store.get("audioFrontHis")||tempResource,$scope.items_video=store.get("videoFrontHis")||tempResource,$scope.banImgs=store.get("banFrontHis")||tempResource,$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?hiden&乐园*history",MobclickAgent.onPageBegin("ParadiseHome")):0==platFlag&&(change_tb.setToolBar("home"),change_tb.sendBroadcast(!0),MobclickAgent.onPageBegin("ParadiseHome"))}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("ParadiseHome"):0==platFlag&&MobclickAgent.onPageEnd("ParadiseHome")}),$scope.init=function(){$scope.doRefresh()},$scope.doRefresh=function(){$scope.ajaxCount=0;var res=WebService.newGetBanner(tsIdLogin);res.$promise.then(function(response){$scope.ajaxCount=$scope.ajaxCount+1,($scope.ajaxCount=4)&&$scope.$broadcast("scroll.refreshComplete");var data=response.data.data,length=data.length;return length<=0?void CommonService.showAlert.show("无banner数据！"):($scope.banImgs=data,$scope.bannerCur=0,$ionicSlideBoxDelegate.update(),void store.set("banFrontHis",data))});var res1=WebService.guessYouLike(tsIdLogin,2,1,4);res1.$promise.then(function(response){$scope.ajaxCount=$scope.ajaxCount+1,($scope.ajaxCount=4)&&$scope.$broadcast("scroll.refreshComplete");var data=response.data.data;$scope.items_audio=data;var length=data.length;length<=0&&CommonService.showAlert.show("无推荐听听数据！"),store.set("audioFrontHis",$scope.items_audio)});var res2=WebService.guessYouLike(tsIdLogin,1,1,4);res2.$promise.then(function(response){$scope.ajaxCount=$scope.ajaxCount+1,($scope.ajaxCount=4)&&$scope.$broadcast("scroll.refreshComplete");var data=response.data.data;$scope.items_video=data;var length=data.length;length<=0&&CommonService.showAlert.show("无推荐课堂数据！"),store.set("videoFrontHis",$scope.items_video)});var res3=WebService.getInformation(tsIdLogin,1,1,6);res3.$promise.then(function(response){$scope.ajaxCount=$scope.ajaxCount+1,($scope.ajaxCount=4)&&$scope.$broadcast("scroll.refreshComplete");var data=response.data.data;$scope.items_eduInf=data;var length=data.length;length<=0&&CommonService.showAlert.show("无推荐资讯数据！"),store.set("infFrontHis",$scope.items_eduInf)})},$scope.$on("ajaxError",function(){$scope.$broadcast("scroll.refreshComplete")}),$scope.goSearch=function(){$state.go("search")},$scope.goHistory=function(){$state.go("history")},$scope.goChildClass=function(){$state.go("childClass")},$scope.goChildMusic=function(){$state.go("childMusic")},$scope.goEduInformation=function(){$rootScope.eduReLoad=!0,$state.go("eduInformation")},$scope.showEduInf=function(item){return 1==item.pay?void CommonService.showAlert.show("小主人，您的套餐已到期暂不能收看了。别难受，尽快续订，和贝贝虎一起愉快的玩耍吧！"):void $state.go("eduInformation_Detail",{resourceid:item.resourceId})},$scope.androidMusicFlag=!0,$scope.playAudio=function(item){if(1==platFlag){var argu="music"+item.albumId+"iosnull";OCdynamicId.iosUsercomment(argu)}else 0==platFlag&&$scope.androidMusicFlag&&($scope.androidMusicFlag=!1,change_tb.startMusicActivity(item.albumId,null),setTimeout(function(){$scope.androidMusicFlag=!0},3e3))},$scope.playVideo=function(item){$state.go("videoPlay",{themeid:item.albumId,resourceid:null})},$scope.slideHasChanged=function(index){$scope.bannerCur=index},$scope.jumpToAddress=function(){var jumpTo=$scope.banImgs[$scope.bannerCur].banner_jump;jumpTo=encodeURI(jumpTo),window.location.href=jumpTo},$scope.init()}),angular.module("app.controllers").controller("SearchCtrl",function($scope,$state,$ionicPopup,$ionicScrollDelegate,WebService,CommonService){$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&搜索*null",MobclickAgent.onPageBegin("Search")):0==platFlag&&(change_tb.setToolBar("search"),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("Search"))}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("Search"):0==platFlag&&MobclickAgent.onPageEnd("Search")}),$scope.init=function(){$scope.showHisBox=1,$scope.showResultBox=0,$scope.inputFocusing=0,$scope.reset(),$scope.getSearchHis()},$scope.inputFocus=function(){$scope.getSearchHis(),$scope.inputFocusing=1},$scope.inputBlur=function(){$scope.inputFocusing=0},$scope.goBack=function(){$state.go("paradiseHome")},$scope.getSearchHis=function(){$scope.items_searchHis=CommonService.searchHisService.getGeneralHis()},$scope.reset=function(){$scope.keyWord=""},$scope.tabCur=4,$scope.changeTab=function(index){$scope.tabCur=index},$scope.playVideo=function(item){$state.go("videoPlay",{themeid:item.albumId,index:item.index})},$scope.androidMusicFlag=!0,$scope.playAudio=function(item){if(1==platFlag){var argu="music"+item.albumId+"ios"+item.resourceId;OCdynamicId.iosUsercomment(argu)}else 0==platFlag&&$scope.androidMusicFlag&&($scope.androidMusicFlag=!1,change_tb.startMusicActivity(item.albumId,item.resourceId),setTimeout(function(){$scope.androidMusicFlag=!0},3e3))},$scope.showInfDet=function(item){return 1==item.pay?void CommonService.showAlert.show("小主人，您的套餐已到期暂不能收看了。别难受，尽快续订，和贝贝虎一起愉快的玩耍吧！"):void $state.go("eduInformation_Detail",{resourceid:item.resourceId})},$scope.search=function(){var key=$scope.keyWord;$scope.keyForSearch=key,$scope.doSearch(),CommonService.searchHisService.addGeneralHis(key)},$scope.quickSearch=function(key){$scope.keyForSearch=key,$scope.doSearch()},$scope.hideHisBox=function(){$scope.showHisBox=0},$scope.doSearch=function(){$scope.showHisBox=0,$scope.tabCur=0,$scope.pageNumber0=1,$scope.pageNumber1=1,$scope.pageNumber2=1,$scope.items_audio=[],$scope.items_video=[],$scope.items_inf=[],$scope.searchByKey0(),$scope.searchByKey1(),$scope.searchByKey2()},$scope.loadState0=0,$scope.searchByKey0=function(){var res=WebService.resourceSearch(tsIdLogin,$scope.keyForSearch,2,6,$scope.pageNumber0);$scope.showResultBox=1,$scope.loadState0=1,res.$promise.then(function(response){var data=response.data.data.resourceManageList,length=data.length;$scope.loadState0=0,length<6&&($scope.loadState0=2,length<=0)||($scope.items_audio=$scope.items_audio.concat(data),$ionicScrollDelegate.resize())})},$scope.loadMoreData0=function(){$scope.pageNumber0=$scope.pageNumber0+1,$scope.searchByKey0()},$scope.loadState1=0,$scope.searchByKey1=function(){var res=WebService.resourceSearch(tsIdLogin,$scope.keyForSearch,1,6,$scope.pageNumber1);$scope.showResultBox=1,$scope.loadState1=1,res.$promise.then(function(response){var data=response.data.data.resourceManageList,length=data.length;$scope.loadState1=0,length<6&&($scope.loadState1=2,length<=0)||($scope.items_video=$scope.items_video.concat(data),$ionicScrollDelegate.resize())})},$scope.loadMoreData1=function(){$scope.pageNumber1=$scope.pageNumber1+1,$scope.searchByKey1()},$scope.loadState2=0,$scope.searchByKey2=function(){var res=WebService.resourceSearch(tsIdLogin,$scope.keyForSearch,3,6,$scope.pageNumber2);$scope.showResultBox=1,$scope.loadState2=1,res.$promise.then(function(response){var data=response.data.data.resourceManageList,length=data.length;$scope.loadState2=0,length<6&&($scope.loadState2=2,length<=0)||($scope.items_inf=$scope.items_inf.concat(data),$ionicScrollDelegate.resize())})},$scope.loadMoreData2=function(){$scope.pageNumber2=$scope.pageNumber2+1,$scope.searchByKey2()},$scope.init()}),angular.module("app.controllers").controller("Search_AudioCtrl",function($scope,$state,$ionicPopup,$ionicScrollDelegate,WebService,CommonService){$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&搜索听听*null",MobclickAgent.onPageBegin("Search_Audio")):0==platFlag&&(change_tb.setToolBar("search_music"),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("Search_Audio"))}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("Search_Audio"):0==platFlag&&MobclickAgent.onPageEnd("Search_Audio")}),$scope.goBack=function(){$state.go("childMusic")},$scope.init=function(){$scope.showHisBox=1,$scope.showResultBox=0,$scope.inputFocusing=0,$scope.loadState=0,$scope.reset(),$scope.getSearchHis()},$scope.inputFocus=function(){$scope.getSearchHis(),$scope.inputFocusing=1},$scope.inputBlur=function(){$scope.inputFocusing=0},$scope.getSearchHis=function(){$scope.items_searchHis=CommonService.searchHisService.getAudioHis()},$scope.reset=function(){$scope.keyWord=""},$scope.search=function(){var key=$scope.keyWord;$scope.keyForSearch=key,$scope.pageNumber=1,$scope.items_audio=[],$scope.searchByKey(),CommonService.searchHisService.addAudioHis(key)},$scope.quickSearch=function(key){$scope.keyForSearch=key,$scope.items_audio=[],$scope.pageNumber=1,$scope.searchByKey()},$scope.hideHisBox=function(){$scope.showHisBox=0},$scope.searchByKey=function(){var res=WebService.resourceSearch(tsIdLogin,$scope.keyForSearch,2,6,$scope.pageNumber);$scope.showResultBox=1,$scope.loadState=1,res.$promise.then(function(response){var data=response.data.data.resourceManageList,length=data.length;$scope.loadState=0,length<6&&($scope.loadState=2,length<=0)||($scope.items_audio=$scope.items_audio.concat(data),$ionicScrollDelegate.resize(),$scope.showHisBox=0)})},$scope.loadMoreData=function(){$scope.pageNumber=$scope.pageNumber+1,$scope.searchByKey()},$scope.androidMusicFlag=!0,$scope.playAudio=function(item){if(1==platFlag){var argu="music"+item.albumId+"ios"+item.resourceId;OCdynamicId.iosUsercomment(argu)}else 0==platFlag&&$scope.androidMusicFlag&&($scope.androidMusicFlag=!1,change_tb.startMusicActivity(item.albumId,item.resourceId),setTimeout(function(){$scope.androidMusicFlag=!0},3e3))},$scope.init()}),angular.module("app.controllers").controller("Search_VideoCtrl",function($scope,$state,$ionicPopup,$ionicScrollDelegate,WebService,CommonService){$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&搜索课堂*null",MobclickAgent.onPageBegin("Search_Video")):0==platFlag&&(change_tb.setToolBar("search_cause"),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("Search_Video"))}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("Search_Video"):0==platFlag&&MobclickAgent.onPageEnd("Search_Video")}),$scope.goBack=function(){$state.go("childClass")},$scope.init=function(){$scope.showHisBox=1,$scope.showResultBox=0,$scope.inputFocusing=0,$scope.loadState=0,$scope.reset(),$scope.getSearchHis()},$scope.inputFocus=function(){$scope.getSearchHis(),$scope.inputFocusing=1},$scope.inputBlur=function(){$scope.inputFocusing=0},$scope.getSearchHis=function(){$scope.items_searchHis=CommonService.searchHisService.getVideoHis()},$scope.reset=function(){$scope.keyWord=""},$scope.search=function(){var key=$scope.keyWord;$scope.keyForSearch=key,$scope.pageNumber=1,$scope.items_video=[],$scope.searchByKey(),CommonService.searchHisService.addVideoHis(key)},$scope.quickSearch=function(key){$scope.keyForSearch=key,$scope.items_video=[],$scope.pageNumber=1,$scope.searchByKey()},$scope.hideHisBox=function(){$scope.showHisBox=0},$scope.searchByKey=function(){var res=WebService.resourceSearch(tsIdLogin,$scope.keyForSearch,1,6,$scope.pageNumber);$scope.showResultBox=1,$scope.loadState=1,res.$promise.then(function(response){var data=response.data.data.resourceManageList,length=data.length;$scope.loadState=0,length<6&&($scope.loadState=2,length<=0)||($scope.items_video=$scope.items_video.concat(data),$ionicScrollDelegate.resize(),$scope.showHisBox=0)})},$scope.loadMoreData=function(){$scope.pageNumber=$scope.pageNumber+1,$scope.searchByKey()},$scope.playVideo=function(item){$state.go("videoPlay",{themeid:item.albumId,index:item.index})},$scope.init()}),angular.module("app.controllers").controller("Search_InfCtrl",function($scope,$rootScope,$state,$ionicPopup,$ionicScrollDelegate,WebService,CommonService){$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&搜索资讯*null",MobclickAgent.onPageBegin("Search_Inf")):0==platFlag&&(change_tb.setToolBar("search_con"),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("Search_Inf"))}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("Search_Inf"):0==platFlag&&MobclickAgent.onPageEnd("Search_Inf")}),$scope.goBack=function(){$state.go("eduInformation")},$scope.init=function(){$scope.showHisBox=1,$scope.showResultBox=0,$scope.inputFocusing=0,$scope.loadState=0,$scope.reset(),$scope.getSearchHis()},$scope.inputFocus=function(){$scope.getSearchHis(),$scope.inputFocusing=1},$scope.inputBlur=function(){$scope.inputFocusing=0},$scope.getSearchHis=function(){$scope.items_searchHis=CommonService.searchHisService.getInfHis()},$scope.reset=function(){$scope.keyWord=""},$scope.search=function(){var key=$scope.keyWord;$scope.keyForSearch=key,$scope.pageNumber=1,$scope.items_inf=[],$scope.searchByKey(),CommonService.searchHisService.addInfHis(key)},$scope.quickSearch=function(key){$scope.keyForSearch=key,$scope.items_inf=[],$scope.pageNumber=1,$scope.searchByKey()},$scope.hideHisBox=function(){$scope.showHisBox=0},$scope.searchByKey=function(){$rootScope.eduReLoad=!0;var res=WebService.resourceSearch(tsIdLogin,$scope.keyForSearch,3,6,$scope.pageNumber);$scope.showResultBox=1,$scope.loadState=1,res.$promise.then(function(response){var data=response.data.data.resourceManageList,length=data.length;$scope.loadState=0,length<6&&($scope.loadState=2,length<=0)||($scope.items_inf=$scope.items_inf.concat(data),$ionicScrollDelegate.resize(),$scope.showHisBox=0)})},$scope.loadMoreData=function(){$scope.pageNumber=$scope.pageNumber+1,$scope.searchByKey()},$scope.showInfDet=function(item){return 1==item.pay?void CommonService.showAlert.show("小主人，您的套餐已到期暂不能收看了。别难受，尽快续订，和贝贝虎一起愉快的玩耍吧！"):void $state.go("eduInformation_Detail",{resourceid:item.resourceId})},$scope.init()}),angular.module("app.controllers").controller("ChildClassCtrl",function($scope,$state,WebService,$ionicScrollDelegate,$ionicPopup,CommonService){$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&幼儿课堂*search_Video",MobclickAgent.onPageBegin("ChildClass")):0==platFlag&&(change_tb.setToolBar("childClass"),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("ChildClass"))}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("ChildClass"):0==platFlag&&MobclickAgent.onPageEnd("ChildClass")}),$scope.tabCur=0,$scope.changeTab=function(index){$scope.tabCur=index},$scope.goBack=function(){$state.go("paradiseHome")},$scope.goSearch_Video=function(){$state.go("search_Video")},$scope.init=function(){$scope.pageNumber=1,$scope.loadState=0,$scope.items_video=[],$scope.loadDataByPageNumber($scope.pageNumber),$scope.loadClassify()},$scope.playVideo=function(item){$state.go("videoPlay",{themeid:item.albumId,resourceid:null})},$scope.loadMoreData=function(){$scope.pageNumber=$scope.pageNumber+1,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.loadDataByPageNumber=function(pageNumber){var res=WebService.guessYouLike(tsIdLogin,1,pageNumber,6);$scope.loadState=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;$scope.loadState=0,length<6&&($scope.loadState=2,length<=0)||($scope.items_video=$scope.items_video.concat(data),$ionicScrollDelegate.resize())})},$scope.goVideoSort=function(item){$state.go("childClass_Sort",{typeid:item.themeId,typename:item.themeName})},$scope.loadClassify=function(){var res=WebService.getThemeList(tsIdLogin,1);res.$promise.then(function(response){var data=response.data.data,length=data.length;return length<=0?void CommonService.showAlert.show("无分类数据！"):($scope.items_videoSort=data,void $ionicScrollDelegate.resize())})},$scope.init()}),angular.module("app.controllers").controller("ChildClass_SortCtrl",function($scope,$state,$stateParams,WebService,$ionicScrollDelegate){$scope.$on("$ionicView.beforeEnter",function(){$scope.typeid=$stateParams.typeid,$scope.typename=$stateParams.typename,1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&"+$scope.typename+"*null",MobclickAgent.onPageBegin("ChildClass_Sort")):0==platFlag&&(change_tb.setClassCauseTitle($scope.typename),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("ChildClass_Sort")),$scope.init()}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("ChildClass_Sort"):0==platFlag&&MobclickAgent.onPageEnd("ChildClass_Sort")}),$scope.goBack=function(){window.history.back()},$scope.init=function(){$scope.items_video=[],$scope.pageNumber=1,$scope.loadState=0,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.playVideo=function(item){$state.go("videoPlay",{themeid:item.albumId,resourceid:null})},$scope.loadMoreData=function(){$scope.pageNumber=$scope.pageNumber+1,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.loadDataByPageNumber=function(pageNumber){var res=WebService.getAlbumByTheme(tsIdLogin,$scope.typeid,pageNumber,8);$scope.loadState=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;return $scope.loadState=0,length<6&&($scope.loadState=2,length<=0)?void(1==pageNumber&&($scope.loadState=3)):($scope.items_video=$scope.items_video.concat(data),void $ionicScrollDelegate.resize())})}}),angular.module("app.controllers").controller("ChildMusicCtrl",function($scope,$state,WebService,$ionicScrollDelegate,$ionicPopup,CommonService){$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&幼儿听听*search_Audio",MobclickAgent.onPageBegin("ChildMusic")):0==platFlag&&(change_tb.setToolBar("mediaplay"),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("ChildMusic"))}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("ChildMusic"):0==platFlag&&MobclickAgent.onPageEnd("ChildMusic")}),$scope.tabCur=0,$scope.changeTab=function(index){$scope.tabCur=index},$scope.goBack=function(){$state.go("paradiseHome")},$scope.goSearch_Audio=function(){$state.go("search_Audio")},$scope.init=function(){$scope.pageNumber=1,$scope.loadState=0,$scope.items_audio=[],$scope.loadDataByPageNumber($scope.pageNumber),$scope.loadClassify()},$scope.androidMusicFlag=!0,$scope.playAudio=function(item){if(1==platFlag){var argu="music"+item.albumId+"iosnull";OCdynamicId.iosUsercomment(argu)}else 0==platFlag&&$scope.androidMusicFlag&&($scope.androidMusicFlag=!1,change_tb.startMusicActivity(item.albumId,null),setTimeout(function(){$scope.androidMusicFlag=!0},3e3))},$scope.loadMoreData=function(){$scope.pageNumber=$scope.pageNumber+1,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.loadDataByPageNumber=function(pageNumber){var res=WebService.guessYouLike(tsIdLogin,2,pageNumber,6);$scope.loadState=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;$scope.loadState=0,length<6&&($scope.loadState=2,length<=0)||($scope.items_audio=$scope.items_audio.concat(data),$ionicScrollDelegate.resize())})},$scope.goAudioSort=function(item){$state.go("childMusic_Sort",{typeid:item.themeId,typename:item.themeName})},$scope.loadClassify=function(){var res=WebService.getThemeList(tsIdLogin,2);res.$promise.then(function(response){var data=response.data.data,length=data.length;return length<=0?void CommonService.showAlert.show("无分类数据！"):($scope.items_audioSort=data,void $ionicScrollDelegate.resize())})},$scope.init()}),angular.module("app.controllers").controller("ChildMusic_SortCtrl",function($scope,$state,$stateParams,WebService,$ionicScrollDelegate){$scope.$on("$ionicView.beforeEnter",function(){$scope.typeid=$stateParams.typeid,$scope.typename=$stateParams.typename,1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&"+$scope.typename+"*null",MobclickAgent.onPageBegin("ChildMusic_Sort")):0==platFlag&&(change_tb.setClassCauseTitle($scope.typename),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("ChildMusic_Sort")),$scope.init()}),$scope.$on("$ionicView.beforeLeave",function(){
1==platFlag?MobclickAgent.onPageEnd("ChildMusic_Sort"):0==platFlag&&MobclickAgent.onPageEnd("ChildMusic_Sort")}),$scope.goBack=function(){window.history.back()},$scope.init=function(){$scope.items_audio=[],$scope.pageNumber=1,$scope.loadState=0,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.androidMusicFlag=!0,$scope.playAudio=function(item){if(1==platFlag){var argu="music"+item.albumId+"iosnull";OCdynamicId.iosUsercomment(argu)}else 0==platFlag&&$scope.androidMusicFlag&&($scope.androidMusicFlag=!1,change_tb.startMusicActivity(item.albumId,null),setTimeout(function(){$scope.androidMusicFlag=!0},3e3))},$scope.loadMoreData=function(){$scope.pageNumber=$scope.pageNumber+1,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.loadDataByPageNumber=function(pageNumber){var res=WebService.getAlbumByTheme(tsIdLogin,$scope.typeid,pageNumber,8);$scope.loadState=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;$scope.loadState=0,length<6&&($scope.loadState=2,length<=0)||($scope.items_audio=$scope.items_audio.concat(data),$ionicScrollDelegate.resize())})}}),angular.module("app.controllers").controller("VideoPlayCtrl",function($scope,$state,$stateParams,$ionicHistory,$ionicPopup,$ionicScrollDelegate,WebService,CommonService){function resizeSetVideoBox(){var length=$scope.items_play.length,width=117*length;$(".SetVideoBox").width(width)}$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&null*null",MobclickAgent.onPageBegin("VideoPlay")):0==platFlag&&(change_tb.setToolBar("video"),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("VideoPlay")),$scope.themeid=$stateParams.themeid,$scope.resourceidFrom=$stateParams.resourceid,$scope.broadcastPace=$stateParams.broadcastPace,$scope.playAccordBroadcastpace=!1,$scope.init()}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("VideoPlay"):0==platFlag&&MobclickAgent.onPageEnd("VideoPlay")}),$scope.goBack=function(){window.history.back()},$scope.init=function(){$scope.loadingTextShow=0,$scope.loadingTextError=0,$scope.getSetByThemeId($scope.themeid,!1),$scope.current={},$scope.items_video=[],$scope.getRecomForyou();var screenWidth=window.screen.width,vHeight=9*screenWidth/16;$(".videoPlayer").height(vHeight),$("#videoPlayerMy").height(vHeight),$(".videoPanel").css("top",vHeight),$scope.currentUser={},$scope.getTsInfo()},$scope.androidVideoFlag=!0,$(".myPlayVideo").click(function(){var pay=$(this).attr("pay");if(console.log("dianji -  pay : "+pay),1==pay)return void $(".alertWrap").show();if(1==platFlag){var argu="video"+$scope.current.themeid+"ios"+$scope.currentIndex;OCdynamicId.iosUsercomment(argu)}else 0==platFlag&&$scope.androidVideoFlag&&($scope.androidVideoFlag=!1,change_tb.startVideoActivity($scope.current.themeid,$scope.current.resourceid),setTimeout(function(){$scope.androidVideoFlag=!0},3e3))}),$scope.getSetByThemeId=function(themeid,fromRecom){var res=WebService.getCompilationsAllResource(tsIdLogin,themeid);res.$promise.then(function(response){var data=response.data.data,length=data.length;return length<=0?void CommonService.showAlert.show("无选集数据！"):($scope.items_play=data,resizeSetVideoBox(),$scope.current.isFavorites=data[0].isFavorites,1==$scope.current.isFavorites?$scope.current.storeActive=!0:$scope.current.storeActive=!1,void(fromRecom?$scope.playVideoByIndex(0):$scope.resourceidFrom?$.each($scope.items_play,function(ind,el){if(el.resourceId==$scope.resourceidFrom){var index=ind;$scope.playVideoByIndex(index),$scope.playAccordBroadcastpace=!0}}):$scope.playVideoByIndex(0)))})},$scope.playVideoByIndex=function(index,broadcastPace){$scope.currentIndex=index,$scope.current.themeid=$scope.items_play[index].albumId,$scope.current.title=$scope.items_play[index].resourceName,$scope.items_play[index].pvcount=$scope.items_play[index].pvcount+1,$scope.current.count=$scope.items_play[index].pvcount,$scope.current.resourceid=$scope.items_play[index].resourceId,$scope.current.beriefe=$scope.items_play[index].description,$scope.current.source=$scope.items_play[index].source,$scope.current.pvcount=$scope.items_play[index].pvcount,$scope.current.imgUrl=$scope.items_play[index].imageUrl,$scope.current.pay=$scope.items_play[index].pay;var resPlayHis=WebService.savePlayTheRecordingBegin(tsIdLogin,$scope.current.resourceid);resPlayHis.$promise.then(function(response){response.data}),1==$scope.items_play[index].isPraise?$scope.current.praiseActive=!0:$scope.current.praiseActive=!1,$scope.items_comment=[],$scope.pageNumber=1,$scope.loadState=0,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.togglePinch=function(){$(".videoCont").toggleClass("pinch")},$scope.getRecomForyou=function(){var res=WebService.guessYouLike(tsIdLogin,1,1,4);res.$promise.then(function(response){var data=response.data.data,length=data.length;return length<=0?void CommonService.showAlert.show("无为你推荐数据！"):void($scope.items_video=data)})},$scope.changePlayByThemeid=function(item){$ionicScrollDelegate.scrollTop(),$scope.getSetByThemeId(item.albumId,!0)},$scope.store=function(){if($scope.current.storeActive)var cancel=2;else var cancel=1;var res=WebService.saveResourceFavorites(tsIdLogin,$scope.current.themeid,cancel);res.$promise.then(function(response){var data=response.data;0==data.code?$scope.current.storeActive?($scope.current.storeActive=!1,CommonService.showAlert.show("取消收藏"+data.data)):($scope.current.storeActive=!0,CommonService.showAlert.show("收藏"+data.data)):CommonService.showAlert.show(data.data)})},$scope.praise=function(){if($scope.current.praiseActive)var cancel=2;else var cancel=1;var res=WebService.subPraise(tsIdLogin,$scope.current.resourceid,cancel);res.$promise.then(function(response){var data=response.data;0==data.code?(CommonService.showAlert.show(data.data),$scope.current.praiseActive?($scope.current.praiseActive=!1,$scope.items_play[$scope.currentIndex].isPraise=2):($scope.current.praiseActive=!0,$scope.items_play[$scope.currentIndex].isPraise=2)):CommonService.showAlert.show(data.data)})},$scope.subComment=function(commentWord){var res=WebService.subComment($scope.current.resourceid,tsIdLogin,commentWord);res.$promise.then(function(response){var data=response.data;if(0==data.code){CommonService.showAlert.show(data.data);var tempComment={tsImgurl:$scope.currentUser.img,tsType:$scope.currentUser.tsType,tsName:$scope.currentUser.ts_name,date:"刚刚",content:commentWord};$scope.items_comment.unshift(tempComment),$scope.commentWord=null,$(".inputBox input").val("")}else CommonService.showAlert.show(data.data)})},$scope.scrollToUp=function(){$scope.positionOrigin=$(".videoPanel .scroll").css("transform");var hight=$(".videoPanel .videoCont").height()+30+$(".videoPanel .SetBox").height()+22+$(".videoPanel .SelContent.RecomForYou").height()+53,toUp="translate3d( 0px,-"+hight+"px,0 ) scale( 1 )";$(".videoPanel>.scroll").css("transform",toUp)},$scope.scrollBack=function(){$(".videoPanel>.scroll").css("transform",$scope.positionOrigin)},$scope.getTsInfo=function(){var res=WebService.getTsInfo(tsIdLogin);res.$promise.then(function(response){var data=response.data;0==data.code?$scope.currentUser=data.data:CommonService.showAlert.show(data.data)})},$scope.loadMoreData=function(){$scope.pageNumber=$scope.pageNumber+1,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.loadDataByPageNumber=function(pageNumber){var res=WebService.getCommentList($scope.current.resourceid,20,pageNumber);$scope.loadState=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;$scope.loadState=0,length<20&&($scope.loadState=2,length<=0)||($scope.items_comment=$scope.items_comment.concat(data),$ionicScrollDelegate.resize())})},$(".myBtn").click(function(){$(".alertWrap").hide()})}),angular.module("app.controllers").controller("EduInformationCtrl",function($scope,$rootScope,$state,WebService,$ionicScrollDelegate){$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&教育资讯*search_Inf",MobclickAgent.onPageBegin("EduInformation")):0==platFlag&&(change_tb.setToolBar("consult"),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("EduInformation")),$scope.getThemeList()}),$scope.getThemeList=function(){var res=WebService.getThemeList(tsIdLogin,3);res.$promise.then(function(response){$scope.themeList=response.data.data,$scope.init(0)})},$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("EduInformation"):0==platFlag&&MobclickAgent.onPageEnd("EduInformation")}),$scope.tabCur=0,$scope.changeTab=function(index){$scope.tabCur=index,$scope.init(index)},$scope.goBack=function(){$state.go("paradiseHome")},$scope.goSearch_Inf=function(){$state.go("search_Inf")},$scope.init=function(tbs){$scope.items_inf=[],$scope.pageNumber=1,$scope.loadState=0,$scope.themeId=$scope.themeList[tbs].themeId,$scope.loadDataByPageNumber($scope.pageNumber,$scope.themeId)},$scope.doRefresh=function(tbs){$scope.init(tbs)},$scope.$on("ajaxError",function(){$scope.$broadcast("scroll.refreshComplete")}),$scope.showInfDet=function(item){return 1==item.pay?void CommonService.showAlert.show("您的资费不足！"):void $state.go("eduInformation_Detail",{resourceid:item.resourceId})},$scope.loadMoreData=function(tbs){$scope.pageNumber=$scope.pageNumber+1,$scope.loadDataByPageNumber($scope.pageNumber,$scope.themeList[tbs].themeId)},$scope.loadDataByPageNumber=function(pageNumber,themeId){var res=WebService.getInformation(tsIdLogin,4,pageNumber,6,themeId);$scope.loadState=1,res.$promise.then(function(response){(pageNumber=1)&&$scope.$broadcast("scroll.refreshComplete");var data=response.data.data,length=data.length;$scope.loadState=0,length<6&&($scope.loadState=2,length<=0)||($scope.items_inf=$scope.items_inf.concat(data),$ionicScrollDelegate.resize())})}}),angular.module("app.controllers").controller("EduInformation_DetailCtrl",function($scope,$state,$stateParams,$ionicHistory,$ionicScrollDelegate,WebService,CommonService){$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&null*null",MobclickAgent.onPageBegin("EduInformation_Detail")):0==platFlag&&(change_tb.setToolBar("consultDetail"),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("EduInformation_Detail")),$scope.resourceid=$stateParams.resourceid,$scope.init()}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("EduInformation_Detail"):0==platFlag&&MobclickAgent.onPageEnd("EduInformation_Detail");var resPlayHisProgress=WebService.savePlayTheRecordingProgress(tsIdLogin,$scope.resourceid,10);resPlayHisProgress.$promise.then(function(response){response.data})}),$scope.init=function(){var res=WebService.getResourceDetail(tsIdLogin,$scope.resourceid);res.$promise.then(function(response){var data=response.data.data;if(!data)return void CommonService.showAlert.show("无资讯数据！");$scope.displayInfName=data.resourceName,$scope.displayInfCnt=data.content,$scope.displaySource=data.author,$scope.displayCreatetime=data.createTime,1==data.isFavorites?$scope.storeActive=!0:$scope.storeActive=!1;var resPlayHis=WebService.savePlayTheRecordingBegin(tsIdLogin,$scope.resourceid);resPlayHis.$promise.then(function(response){var data=response.data;console.log(data.data)})}),$scope.currentUser={},$scope.getTsInfo(),$scope.items_comment=[],$scope.pageNumber=1,$scope.loadState=0,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.goBack=function(){$ionicHistory.goBack()},$scope.store=function(){if($scope.storeActive)var cancel=2;else var cancel=1;var res=WebService.saveResourceFavorites(tsIdLogin,$scope.resourceid,cancel);res.$promise.then(function(response){var data=response.data;0==data.code?$scope.storeActive?($scope.storeActive=!1,data.isFavorites=2,CommonService.showAlert.show("取消收藏"+data.data)):($scope.storeActive=!0,data.isFavorites=1,CommonService.showAlert.show("收藏"+data.data)):CommonService.showAlert.show(data.data)})},$scope.subComment=function(commentWord){var res=WebService.subComment($scope.resourceid,tsIdLogin,commentWord);res.$promise.then(function(response){var data=response.data;if(0==data.code){CommonService.showAlert.show(data.data);var tempComment={tsImgurl:$scope.currentUser.img,tsType:$scope.currentUser.tsType,tsName:$scope.currentUser.ts_name,date:"刚刚",content:commentWord};$scope.items_comment.unshift(tempComment),$scope.commentWord=null,$(".inputBox input").val("")}else CommonService.showAlert.show(data.data)})},$scope.getTsInfo=function(){var res=WebService.getTsInfo(tsIdLogin);res.$promise.then(function(response){var data=response.data;0==data.code?$scope.currentUser=data.data:CommonService.showAlert.show(data.data)})},$scope.loadMoreData=function(){$scope.pageNumber=$scope.pageNumber+1,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.loadDataByPageNumber=function(pageNumber){var res=WebService.getCommentList($scope.resourceid,20,pageNumber);$scope.loadState=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;$scope.loadState=0,length<20&&($scope.loadState=2,length<=0)||($scope.items_comment=$scope.items_comment.concat(data),$ionicScrollDelegate.resize())})},$scope.scrollToUp=function(){$scope.positionOrigin=$(".InfDetContent.eduInf>.scroll").css("transform");var hight=$(".InfDetContent.eduInf .InfDetContent").height()+160,toUp="translate3d( 0px,-"+hight+"px,0 ) scale( 1 )";$(".InfDetContent.eduInf>.scroll").css("transform",toUp)},$scope.scrollBack=function(){$(".InfDetContent.eduInf>.scroll").css("transform",$scope.positionOrigin)}});