function setWebViewFlag(){isWebviewFlag=!0}function loadURL(url){var iFrame;iFrame=document.createElement("iframe"),iFrame.setAttribute("src",url),iFrame.setAttribute("style","display:none;"),iFrame.setAttribute("height","0px"),iFrame.setAttribute("width","0px"),iFrame.setAttribute("frameborder","0"),document.body.appendChild(iFrame),iFrame.parentNode.removeChild(iFrame),iFrame=null}function exec(funName,args){var commend={functionName:funName,arguments:args},jsonStr=JSON.stringify(commend),url="umeng:"+jsonStr;loadURL(url)}var isWebviewFlag,MobclickAgent={getDeviceId:function(callBack){isWebviewFlag&&exec("getDeviceId",[callBack.name])},onCCEvent:function(evenArray,evenValue,eventLabel){isWebviewFlag&&exec("onCCEvent",[evenArray,evenValue,eventLabel])},onEvent:function(eventId){isWebviewFlag&&exec("onEvent",[eventId])},onEventWithLabel:function(eventId,eventLabel){isWebviewFlag&&exec("onEventWithLabel",[eventId,eventLabel])},onEventWithParameters:function(eventId,eventData){isWebviewFlag&&exec("onEventWithParameters",[eventId,eventData])},onEventWithCounter:function(eventId,eventData,eventNum){isWebviewFlag&&exec("onEventWithCounter",[eventId,eventData,eventNum])},onPageBegin:function(pageName){isWebviewFlag&&exec("onPageBegin",[pageName])},onPageEnd:function(pageName){isWebviewFlag&&exec("onPageEnd",[pageName])},profileSignInWithPUID:function(UID){isWebviewFlag&&exec("profileSignInWithPUID",[UID])},profileSignInWithPUIDWithProvider:function(provider,UID){isWebviewFlag&&exec("profileSignInWithPUIDWithProvider",[provider,UID])},profileSignOff:function(){isWebviewFlag&&exec("profileSignOff",[])},setUserLevelId:function(level){isWebviewFlag&&exec("setUserLevelId",[level])},startLevel:function(level){isWebviewFlag&&exec("startLevel",[level])},finishLevel:function(level){isWebviewFlag&&exec("finishLevel",[level])},failLevel:function(level){isWebviewFlag&&exec("failLevel",[level])},exchange:function(currencyAmount,currencyType,virtualAmount,channel,orderId){isWebviewFlag&&exec("exchange",[currencyAmount,currencyType,virtualAmount,channel,orderId])},pay:function(money,coin,source){isWebviewFlag&&exec("pay",[money,coin,source])},payWithItem:function(money,item,number,price,source){isWebviewFlag&&exec("payWithItem",[money,item,number,price,source])},buy:function(item,number,price){isWebviewFlag&&exec("buy",[item,number,price])},use:function(item,number,price){isWebviewFlag&&exec("use",[item,number,price])},bonusWithItem:function(item,number,price,source){isWebviewFlag&&exec("bonusWithItem",[item,number,price,source])},bonus:function(coin,source){isWebviewFlag&&exec("bonus",[coin,source])}};angular.module("app.constants",[]).constant("BASE_URL","http://eduslb.openhunme.com/KidsWorld"),angular.module("app.directives",[]),angular.module("app.filters",[]),angular.module("app.filters").filter("numberTo4",function(){return function(input){if(input){if(input>=1e3){var newNum=(input/1e4).toFixed(1);return newNum+"万"}return input}return 0}}),angular.module("app.filters").filter("timeToMinute",function(){return function(input){return input?input.substring(5,16):""}}),angular.module("app.services",[]),angular.module("app.services").factory("AjaxService",function($http,$httpParamSerializerJQLike,$q,$ionicLoading,CommonService,BASE_URL,$rootScope){return{ajax:function(options){var url=options.url;options.useBaseUrl&&(url=BASE_URL+options.url);var httpOption={method:options.type||"post",url:url};if("post"==httpOption.method)httpOption.data=options.data||{};else{var pString=$httpParamSerializerJQLike(options.data||{});httpOption.url+=pString?"?"+pString:""}var deferred=$q.defer();return"post"==httpOption.method?$.ajax({type:"post",url:httpOption.url,data:httpOption.data,dataType:"json",success:function(data){return data.code==-9?void CommonService.showAlert.show("系统繁忙"):void deferred.resolve({data:data})},error:function(data){CommonService.showAlert.show("请求失败"),$rootScope.$broadcast("ajaxError"),deferred.reject(data)}}):$http(httpOption).success(function(data,status,header,config){return data.code==-9?void CommonService.showAlert.show("系统繁忙"):void deferred.resolve({data:data})}).error(function(data,status,header,config){CommonService.showAlert.show("请求失败"),$rootScope.$broadcast("ajaxError"),deferred.reject(data)}),{$promise:deferred.promise}}}}),angular.module("app.services").factory("WebService",function(AjaxService){return{getHomeBanner:function(tsId){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getBanner.do",options.data={tsId:tsId},AjaxService.ajax(options)},getRecommenda:function(tsId,size,type){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getRecommenda.do",options.data={tsId:tsId,size:size,type:type},AjaxService.ajax(options)},getIndexAllRecommenda:function(tsId,size){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getIndexAllRecommenda.do",options.data={tsId:tsId,size:size},AjaxService.ajax(options)},getContent:function(tsId,type,pageSize,pageNumber,typeid){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getContent.do",options.data={tsId:tsId,type:type,pageSize:pageSize,pageNumber:pageNumber,typeid:typeid},AjaxService.ajax(options)},getClassify:function(tsId,type){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getClassify.do",options.data={tsId:tsId,type:type},AjaxService.ajax(options)},getContentInfo:function(tsId,themeid){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getContentInfo.do",options.data={tsId:tsId,themeid:themeid},AjaxService.ajax(options)},subAttention:function(tsId,resourceid,cancel){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/subAttention.do",options.data={tsId:tsId,resourceid:resourceid,cancel:cancel},AjaxService.ajax(options)},subPraise:function(tsId,resourceid,cancel){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/subPraise.do",options.data={tsId:tsId,resourceid:resourceid,cancel:cancel},AjaxService.ajax(options)},getResourceListByName:function(name,type,pageSize,pageNumber){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getResourceListByName.do",options.data={name:name,type:type,pageSize:pageSize,pageNumber:pageNumber},AjaxService.ajax(options)},getMyAttentionResourceList:function(tsId,type,pageSize,pageNumber){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getMyAttentionResourceList.do",options.data={tsId:tsId,type:type,pageSize:pageSize,pageNumber:pageNumber},AjaxService.ajax(options)},getResourceDetail:function(tsId,resourceid){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getResourceDetail.do",options.data={tsId:tsId,resourceid:resourceid},AjaxService.ajax(options)},updateResourcePv:function(resourceid){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/updateResourcePv",options.data={resourceid:resourceid},AjaxService.ajax(options)},subComment:function(resourceid,tsId,content){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/subComment",options.data={resourceid:resourceid,tsId:tsId,content:content},AjaxService.ajax(options)},getCommentList:function(resourceid,pageSize,pageNumber){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getCommentList",options.data={resourceid:resourceid,pageSize:pageSize,pageNumber:pageNumber},AjaxService.ajax(options)},getTsInfo:function(tsId){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getTsInfo",options.data={tsId:tsId},AjaxService.ajax(options)}}}),angular.module("app.services").factory("CommonService",function(){function addSearchHisItemByKey(key,item){var history=store.get(key);if(history){$.each(history,function(ind,el){if(el.searchHis==item)return history.splice(ind,1),!1});var length=history.length;length<10?history.unshift({searchHis:item}):length>=10&&(history.splice(length-1,1),history.unshift({searchHis:item}))}else history=[{searchHis:item}];store.set(key,history)}function addPlayHisItemByKey(key,item){var history=store.get(key);if(history){$.each(history,function(ind,el){if(el.id==item.id)return history.splice(ind,1),!1});var length=history.length;length<10?history.unshift(item):length>=10&&(history.splice(length-1,1),history.unshift(item))}else history=[item];store.set(key,history)}return{showAlert:{cfg:{id:".kBubble",speed:2e3},show:function(str){var oBubble=$(this.cfg.id);oBubble.length||(oBubble=$('<div class="kBubble" />').appendTo($("body")),oBubble.html(str).fadeIn()),setTimeout("$('.kBubble').fadeOut('slow',function(){$('.kBubble').remove();})",this.cfg.speed)}},playHisService:{addAudioHis:function(item){addPlayHisItemByKey("audioHistory",item)},getAudioHis:function(){return store.get("audioHistory")},addVideoHis:function(item){addPlayHisItemByKey("videoHistory",item)},getVideoHis:function(){return store.get("videoHistory")},addInfHis:function(item){addPlayHisItemByKey("infHistory",item)},getInfHis:function(){return store.get("infHistory")}},searchHisService:{addGeneralHis:function(item){addSearchHisItemByKey("generalSearchHistory",item)},getGeneralHis:function(){return store.get("generalSearchHistory")},addAudioHis:function(item){addSearchHisItemByKey("audioSearchHistory",item)},getAudioHis:function(){return store.get("audioSearchHistory")},addVideoHis:function(item){addSearchHisItemByKey("videoSearchHistory",item)},getVideoHis:function(){return store.get("videoSearchHistory")},addInfHis:function(item){addSearchHisItemByKey("infSearchHistory",item)},getInfHis:function(){return store.get("infSearchHistory")}}}}),angular.module("app",["ui.router","ngAnimate","ionic","app.services","app.controllers","app.constants","app.directives","app.filters"]).run(function($rootScope,$state){function onDeviceReady(){}$rootScope.$on("$stateChangeStart",function(event,next){}),document.addEventListener("deviceready",onDeviceReady,!1)}).config(function($stateProvider,$urlRouterProvider,$ionicConfigProvider){$ionicConfigProvider.views.maxCache(1),$stateProvider.state("paradiseHome",{url:"/paradiseHome",templateUrl:"views/paradiseHome.html",controller:"ParadiseHomeCtrl"}).state("search",{url:"/search",templateUrl:"views/search.html",controller:"SearchCtrl"}).state("search_Audio",{url:"/search_Audio",templateUrl:"views/search_Audio.html",controller:"Search_AudioCtrl"}).state("search_Video",{url:"/search_Video",templateUrl:"views/search_Video.html",controller:"Search_VideoCtrl"}).state("search_Inf",{url:"/search_Inf",templateUrl:"views/search_Inf.html",controller:"Search_InfCtrl"}).state("collect",{url:"/collect",templateUrl:"views/collect.html",controller:"CollectCtrl"}).state("history",{url:"/history",templateUrl:"views/history.html",controller:"HistoryCtrl"}).state("childClass",{url:"/childClass",templateUrl:"views/childClass.html",controller:"ChildClassCtrl"}).state("childClass_Sort",{url:"/childClass_Sort?typeid&typename",templateUrl:"views/childClass_Sort.html",controller:"ChildClass_SortCtrl"}).state("childMusic",{url:"/childMusic",templateUrl:"views/childMusic.html",controller:"ChildMusicCtrl"}).state("childMusic_Sort",{url:"/childMusic_Sort?typeid&typename",templateUrl:"views/childMusic_Sort.html",controller:"ChildMusic_SortCtrl"}).state("eduInformation",{url:"/eduInformation",templateUrl:"views/eduInformation.html",controller:"EduInformationCtrl"}).state("videoPlay",{url:"/videoPlay?themeid&resourceid",templateUrl:"views/videoPlay.html",controller:"VideoPlayCtrl"}).state("audioPlay",{url:"/audioPlay?themeid&resourceid",templateUrl:"views/audioPlay.html",controller:"AudioPlayCtrl"}).state("eduInformation_Detail",{url:"/eduInformation_Detail?resourceid",templateUrl:"views/eduInformation_Detail.html",controller:"EduInformation_DetailCtrl"}),$urlRouterProvider.otherwise("paradiseHome")}),angular.module("app.controllers",[]),angular.module("app.controllers").controller("ParadiseHomeCtrl",function($scope,$rootScope,$ionicLoading,$ionicSlideBoxDelegate,$state,$ionicPopup,WebService,CommonService){var tempResource=[{imgUrl:"images/icon/default_16_9.png",name:"."},{imgUrl:"images/icon/default_16_9.png",name:"."},{imgUrl:"images/icon/default_16_9.png",name:"."},{imgUrl:"images/icon/default_16_9.png",name:"."}];$scope.items_eduInf=store.get("infFrontHis")||tempResource,$scope.items_audio=store.get("audioFrontHis")||tempResource,$scope.items_video=store.get("videoFrontHis")||tempResource,$scope.banImgs=store.get("banFrontHis")||tempResource,$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?hiden&乐园*history",MobclickAgent.onPageBegin("ParadiseHome")):0==platFlag&&(change_tb.setToolBar("home"),change_tb.sendBroadcast(!0),MobclickAgent.onPageBegin("ParadiseHome"))}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("ParadiseHome"):0==platFlag&&MobclickAgent.onPageEnd("ParadiseHome")}),$scope.init=function(){$scope.doRefresh()},$scope.doRefresh=function(){$scope.ajaxCount=0;var res=WebService.getHomeBanner(tsIdLogin);res.$promise.then(function(response){$scope.ajaxCount=$scope.ajaxCount+1,($scope.ajaxCount=2)&&$scope.$broadcast("scroll.refreshComplete");var data=response.data.data,length=data.length;return length<=0?void CommonService.showAlert.show("无banner数据！"):($scope.banImgs=data,$scope.bannerCur=0,$ionicSlideBoxDelegate.update(),void store.set("banFrontHis",data))});var res1=WebService.getIndexAllRecommenda(tsIdLogin,6);res1.$promise.then(function(response){$scope.ajaxCount=$scope.ajaxCount+1,($scope.ajaxCount=2)&&$scope.$broadcast("scroll.refreshComplete");var data=response.data.data,length=data.length;if(length<=0)return void CommonService.showAlert.show("无推荐数据！");var data_0=data[0].contentJsonList;$scope.items_audio=data[0].contentJsonList.slice(0,4);var length_0=data_0.length;length_0<=0&&CommonService.showAlert.show("无推荐听听数据！");var data_1=data[1].contentJsonList;$scope.items_video=data[1].contentJsonList.slice(0,4);var length_1=data_1.length;length_1<=0&&CommonService.showAlert.show("无推荐课堂数据！");var data_2=data[2].resourceJsonList;$scope.items_eduInf=data[2].resourceJsonList;var length_2=data_2.length;length_2<=0&&CommonService.showAlert.show("无推荐资讯数据！"),store.set("audioFrontHis",$scope.items_audio),store.set("videoFrontHis",$scope.items_video),store.set("infFrontHis",$scope.items_eduInf)})},$scope.$on("ajaxError",function(){$scope.$broadcast("scroll.refreshComplete")}),$scope.goSearch=function(){clearInterval($rootScope.bannnerTimer),$state.go("search")},$scope.goHistory=function(){clearInterval($rootScope.bannnerTimer),$state.go("history")},$scope.goChildClass=function(){clearInterval($rootScope.bannnerTimer),$state.go("childClass")},$scope.goChildMusic=function(){clearInterval($rootScope.bannnerTimer),$state.go("childMusic")},$scope.goEduInformation=function(){clearInterval($rootScope.bannnerTimer),$rootScope.eduReLoad=!0,$state.go("eduInformation")},$scope.showEduInf=function(item){clearInterval($rootScope.bannnerTimer),$state.go("eduInformation_Detail",{resourceid:item.id})},$scope.playAudio=function(item){clearInterval($rootScope.bannnerTimer),$state.go("audioPlay",{themeid:item.id,resourceid:null})},$scope.playVideo=function(item){clearInterval($rootScope.bannnerTimer),$state.go("videoPlay",{themeid:item.id,resourceid:null})},$scope.slideHasChanged=function(index){$scope.bannerCur=index},$scope.jumpToAddress=function(){var jumpTo=$scope.banImgs[$scope.bannerCur].jumpAddress;jumpTo=encodeURI(jumpTo),window.location.href=jumpTo},$scope.init()}),angular.module("app.controllers").controller("SearchCtrl",function($scope,$state,$ionicPopup,$ionicScrollDelegate,WebService,CommonService){$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&搜索*null",MobclickAgent.onPageBegin("Search")):0==platFlag&&(change_tb.setToolBar("search"),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("Search"))}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("Search"):0==platFlag&&MobclickAgent.onPageEnd("Search")}),$scope.init=function(){$scope.showHisBox=1,$scope.showResultBox=0,$scope.inputFocusing=0,$scope.reset(),$scope.getSearchHis()},$scope.inputFocus=function(){$scope.getSearchHis(),$scope.inputFocusing=1},$scope.inputBlur=function(){$scope.inputFocusing=0},$scope.goBack=function(){$state.go("paradiseHome")},$scope.getSearchHis=function(){$scope.items_searchHis=CommonService.searchHisService.getGeneralHis()},$scope.reset=function(){$scope.keyWord=""},$scope.tabCur=4,$scope.changeTab=function(index){$scope.tabCur=index},$scope.playVideo=function(item){$state.go("videoPlay",{themeid:item.themeid,resourceid:item.id})},$scope.playAudio=function(item){$state.go("audioPlay",{themeid:item.themeid,resourceid:item.id})},$scope.showInfDet=function(item){$state.go("eduInformation_Detail",{resourceid:item.id})},$scope.search=function(){var key=$scope.keyWord;$scope.keyForSearch=key,CommonService.searchHisService.addGeneralHis(key),$scope.doSearch()},$scope.quickSearch=function(key){$scope.keyForSearch=key,$scope.doSearch()},$scope.hideHisBox=function(){$scope.showHisBox=0},$scope.doSearch=function(){$scope.showHisBox=0,$scope.tabCur=0,$scope.pageNumber0=1,$scope.pageNumber1=1,$scope.pageNumber2=1,$scope.items_audio=[],$scope.items_video=[],$scope.items_inf=[],$scope.searchByKey0(),$scope.searchByKey1(),$scope.searchByKey2()},$scope.loadState0=0,$scope.searchByKey0=function(){var res=WebService.getResourceListByName($scope.keyForSearch,1,6,$scope.pageNumber0);$scope.showResultBox=1,$scope.loadState0=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;$scope.loadState0=0,length<6&&($scope.loadState0=2,length<=0)||($scope.items_audio=$scope.items_audio.concat(data),$ionicScrollDelegate.resize())})},$scope.loadMoreData0=function(){$scope.pageNumber0=$scope.pageNumber0+1,$scope.searchByKey0()},$scope.loadState1=0,$scope.searchByKey1=function(){var res=WebService.getResourceListByName($scope.keyForSearch,0,6,$scope.pageNumber1);$scope.showResultBox=1,$scope.loadState1=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;$scope.loadState1=0,length<6&&($scope.loadState1=2,length<=0)||($scope.items_video=$scope.items_video.concat(data),$ionicScrollDelegate.resize())})},$scope.loadMoreData1=function(){$scope.pageNumber1=$scope.pageNumber1+1,$scope.searchByKey1()},$scope.loadState2=0,$scope.searchByKey2=function(){var res=WebService.getResourceListByName($scope.keyForSearch,2,6,$scope.pageNumber2);$scope.showResultBox=1,$scope.loadState2=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;$scope.loadState2=0,length<6&&($scope.loadState2=2,length<=0)||($scope.items_inf=$scope.items_inf.concat(data),$ionicScrollDelegate.resize())})},$scope.loadMoreData2=function(){$scope.pageNumber2=$scope.pageNumber2+1,$scope.searchByKey2()},$scope.init()}),angular.module("app.controllers").controller("Search_AudioCtrl",function($scope,$state,$ionicPopup,$ionicScrollDelegate,WebService,CommonService){$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&搜索听听*null",MobclickAgent.onPageBegin("Search_Audio")):0==platFlag&&(change_tb.setToolBar("search_music"),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("Search_Audio"))}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("Search_Audio"):0==platFlag&&MobclickAgent.onPageEnd("Search_Audio")}),$scope.goBack=function(){$state.go("childMusic")},$scope.init=function(){$scope.showHisBox=1,$scope.showResultBox=0,$scope.inputFocusing=0,$scope.loadState=0,$scope.reset(),$scope.getSearchHis()},$scope.inputFocus=function(){$scope.getSearchHis(),$scope.inputFocusing=1},$scope.inputBlur=function(){$scope.inputFocusing=0},$scope.getSearchHis=function(){$scope.items_searchHis=CommonService.searchHisService.getAudioHis()},$scope.reset=function(){$scope.keyWord=""},$scope.search=function(){var key=$scope.keyWord;$scope.keyForSearch=key,CommonService.searchHisService.addAudioHis(key),$scope.pageNumber=1,$scope.items_audio=[],$scope.searchByKey()},$scope.quickSearch=function(key){$scope.keyForSearch=key,$scope.items_audio=[],$scope.pageNumber=1,$scope.searchByKey()},$scope.hideHisBox=function(){$scope.showHisBox=0},$scope.searchByKey=function(){var res=WebService.getResourceListByName($scope.keyForSearch,1,6,$scope.pageNumber);$scope.showResultBox=1,$scope.loadState=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;$scope.loadState=0,length<6&&($scope.loadState=2,length<=0)||($scope.items_audio=$scope.items_audio.concat(data),$ionicScrollDelegate.resize(),$scope.showHisBox=0)})},$scope.loadMoreData=function(){$scope.pageNumber=$scope.pageNumber+1,$scope.searchByKey()},$scope.playAudio=function(item){$state.go("audioPlay",{themeid:item.themeid,resourceid:item.id})},$scope.init()}),angular.module("app.controllers").controller("Search_VideoCtrl",function($scope,$state,$ionicPopup,$ionicScrollDelegate,WebService,CommonService){$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&搜索课堂*null",MobclickAgent.onPageBegin("Search_Video")):0==platFlag&&(change_tb.setToolBar("search_cause"),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("Search_Video"))}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("Search_Video"):0==platFlag&&MobclickAgent.onPageEnd("Search_Video")}),$scope.goBack=function(){$state.go("childClass")},$scope.init=function(){$scope.showHisBox=1,$scope.showResultBox=0,$scope.inputFocusing=0,$scope.loadState=0,$scope.reset(),$scope.getSearchHis()},$scope.inputFocus=function(){$scope.getSearchHis(),$scope.inputFocusing=1},$scope.inputBlur=function(){$scope.inputFocusing=0},$scope.getSearchHis=function(){$scope.items_searchHis=CommonService.searchHisService.getVideoHis()},$scope.reset=function(){$scope.keyWord=""},$scope.search=function(){var key=$scope.keyWord;$scope.keyForSearch=key,CommonService.searchHisService.addVideoHis(key),$scope.pageNumber=1,$scope.items_video=[],$scope.searchByKey()},$scope.quickSearch=function(key){$scope.keyForSearch=key,$scope.items_video=[],$scope.pageNumber=1,$scope.searchByKey()},$scope.hideHisBox=function(){$scope.showHisBox=0},$scope.searchByKey=function(){var res=WebService.getResourceListByName($scope.keyForSearch,0,6,$scope.pageNumber);$scope.showResultBox=1,$scope.loadState=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;$scope.loadState=0,length<6&&($scope.loadState=2,length<=0)||($scope.items_video=$scope.items_video.concat(data),$ionicScrollDelegate.resize(),$scope.showHisBox=0)})},$scope.loadMoreData=function(){$scope.pageNumber=$scope.pageNumber+1,$scope.searchByKey()},$scope.playVideo=function(item){$state.go("videoPlay",{themeid:item.themeid,resourceid:item.id})},$scope.init()}),angular.module("app.controllers").controller("Search_InfCtrl",function($scope,$rootScope,$state,$ionicPopup,$ionicScrollDelegate,WebService,CommonService){$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&搜索资讯*null",MobclickAgent.onPageBegin("Search_Inf")):0==platFlag&&(change_tb.setToolBar("search_con"),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("Search_Inf"))}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("Search_Inf"):0==platFlag&&MobclickAgent.onPageEnd("Search_Inf")}),$scope.goBack=function(){$state.go("eduInformation")},$scope.init=function(){$scope.showHisBox=1,$scope.showResultBox=0,$scope.inputFocusing=0,$scope.loadState=0,$scope.reset(),$scope.getSearchHis()},$scope.inputFocus=function(){$scope.getSearchHis(),$scope.inputFocusing=1},$scope.inputBlur=function(){$scope.inputFocusing=0},$scope.getSearchHis=function(){$scope.items_searchHis=CommonService.searchHisService.getInfHis()},$scope.reset=function(){$scope.keyWord=""},$scope.search=function(){var key=$scope.keyWord;$scope.keyForSearch=key,CommonService.searchHisService.addInfHis(key),$scope.pageNumber=1,$scope.items_inf=[],$scope.searchByKey()},$scope.quickSearch=function(key){$scope.keyForSearch=key,$scope.items_inf=[],$scope.pageNumber=1,$scope.searchByKey()},$scope.hideHisBox=function(){$scope.showHisBox=0},$scope.searchByKey=function(){$rootScope.eduReLoad=!0;var res=WebService.getResourceListByName($scope.keyForSearch,2,6,$scope.pageNumber);$scope.showResultBox=1,$scope.loadState=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;$scope.loadState=0,length<6&&($scope.loadState=2,length<=0)||($scope.items_inf=$scope.items_inf.concat(data),$ionicScrollDelegate.resize(),$scope.showHisBox=0)})},$scope.loadMoreData=function(){$scope.pageNumber=$scope.pageNumber+1,$scope.searchByKey()},$scope.showInfDet=function(item){$state.go("eduInformation_Detail",{resourceid:item.id})},$scope.init()}),angular.module("app.controllers").controller("CollectCtrl",function($scope,$state,WebService,$ionicScrollDelegate){$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&我的收藏*null",MobclickAgent.onPageBegin("Collect")):0==platFlag&&MobclickAgent.onPageBegin("Collect")}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("Collect"):0==platFlag&&MobclickAgent.onPageEnd("Collect")}),$scope.tabCur=0,$scope.changeTab=function(index){$scope.tabCur=index},$scope.playVideo=function(item){$state.go("videoPlay",{themeid:item.themeid,resourceid:item.id})},$scope.playAudio=function(item){$state.go("audioPlay",{themeid:item.themeid,resourceid:item.id})},$scope.showInfDet=function(item){$state.go("eduInformation_Detail",{resourceid:item.id})},$scope.init=function(){$scope.pageNumber0=1,$scope.pageNumber1=1,$scope.pageNumber2=1,$scope.items_audio=[],$scope.items_video=[],$scope.items_inf=[],$scope.searchCollect0(),$scope.searchCollect1(),$scope.searchCollect2()},$scope.loadState0=0,$scope.searchCollect0=function(){var res=WebService.getMyAttentionResourceList(tsIdLogin,1,10,$scope.pageNumber0);$scope.loadState0=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;$scope.loadState0=0,length<10&&($scope.loadState0=2,length<=0)||($scope.items_audio=$scope.items_audio.concat(data),$ionicScrollDelegate.resize())})},$scope.loadMoreData0=function(){$scope.pageNumber0=$scope.pageNumber0+1,$scope.searchCollect0()},$scope.loadState1=0,$scope.searchCollect1=function(){var res=WebService.getMyAttentionResourceList(tsIdLogin,0,10,$scope.pageNumber1);$scope.loadState1=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;$scope.loadState1=0,length<10&&($scope.loadState1=2,length<=0)||($scope.items_video=$scope.items_video.concat(data),$ionicScrollDelegate.resize())})},$scope.loadMoreData1=function(){$scope.pageNumber1=$scope.pageNumber1+1,$scope.searchCollect1()},$scope.loadState2=0,$scope.searchCollect2=function(){var res=WebService.getMyAttentionResourceList(tsIdLogin,2,10,$scope.pageNumber2);$scope.loadState2=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;$scope.loadState2=0,length<10&&($scope.loadState2=2,length<=0)||($scope.items_inf=$scope.items_inf.concat(data),$ionicScrollDelegate.resize())})},$scope.loadMoreData2=function(){$scope.pageNumber2=$scope.pageNumber2+1,$scope.searchCollect2()},$scope.init()}),angular.module("app.controllers").controller("HistoryCtrl",function($scope,$state,$ionicScrollDelegate,WebService,CommonService){$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&播放记录*null",MobclickAgent.onPageBegin("History")):0==platFlag&&(change_tb.setToolBar("play_history"),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("History")),$scope.init()}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("History"):0==platFlag&&MobclickAgent.onPageEnd("History")}),$scope.tabCur=0,$scope.changeTab=function(index){$scope.tabCur=index},$scope.goBack=function(){$state.go("paradiseHome")},$scope.init=function(){$scope.items_video=CommonService.playHisService.getVideoHis(),$scope.items_video?$scope.hasHis0=1:$scope.hasHis0=0,$scope.items_audio=CommonService.playHisService.getAudioHis(),$scope.items_audio?$scope.hasHis1=1:$scope.hasHis1=0,$scope.items_inf=CommonService.playHisService.getInfHis(),$scope.items_inf?$scope.hasHis2=1:$scope.hasHis2=0},$scope.playVideo=function(item){$state.go("videoPlay",{themeid:item.themeid,resourceid:item.id})},$scope.playAudio=function(item){$state.go("audioPlay",{themeid:item.themeid,resourceid:item.id})},$scope.showInfDet=function(item){$state.go("eduInformation_Detail",{resourceid:item.id})}}),angular.module("app.controllers").controller("ChildClassCtrl",function($scope,$state,WebService,$ionicScrollDelegate,$ionicPopup,CommonService){$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&幼儿课堂*search_Video",MobclickAgent.onPageBegin("ChildClass")):0==platFlag&&(change_tb.setToolBar("childClass"),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("ChildClass"))}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("ChildClass"):0==platFlag&&MobclickAgent.onPageEnd("ChildClass")}),$scope.tabCur=0,$scope.changeTab=function(index){$scope.tabCur=index},$scope.goBack=function(){$state.go("paradiseHome")},$scope.goSearch_Video=function(){$state.go("search_Video")},$scope.init=function(){$scope.pageNumber=1,$scope.loadState=0,$scope.items_video=[],$scope.loadDataByPageNumber($scope.pageNumber),$scope.loadClassify()},$scope.playVideo=function(item){$state.go("videoPlay",{themeid:item.id,resourceid:null})},$scope.loadMoreData=function(){$scope.pageNumber=$scope.pageNumber+1,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.loadDataByPageNumber=function(pageNumber){var res=WebService.getContent(tsIdLogin,0,6,pageNumber);$scope.loadState=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;$scope.loadState=0,length<6&&($scope.loadState=2,length<=0)||($scope.items_video=$scope.items_video.concat(data),$ionicScrollDelegate.resize())})},$scope.goVideoSort=function(item){$state.go("childClass_Sort",{typeid:item.id,typename:item.name})},$scope.loadClassify=function(){var res=WebService.getClassify(tsIdLogin,0);res.$promise.then(function(response){var data=response.data.data,length=data.length;return length<=0?void CommonService.showAlert.show("无分类数据！"):($scope.items_videoSort=data,void $ionicScrollDelegate.resize())})},$scope.init()}),angular.module("app.controllers").controller("ChildClass_SortCtrl",function($scope,$state,$stateParams,WebService,$ionicScrollDelegate){$scope.$on("$ionicView.beforeEnter",function(){$scope.typeid=$stateParams.typeid,$scope.typename=$stateParams.typename,1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&"+$scope.typename+"*null",MobclickAgent.onPageBegin("ChildClass_Sort")):0==platFlag&&(change_tb.setClassCauseTitle($scope.typename),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("ChildClass_Sort")),$scope.init()}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("ChildClass_Sort"):0==platFlag&&MobclickAgent.onPageEnd("ChildClass_Sort")}),$scope.goBack=function(){window.history.back()},$scope.init=function(){$scope.items_video=[],$scope.pageNumber=1,$scope.loadState=0,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.playVideo=function(item){$state.go("videoPlay",{themeid:item.id,resourceid:null})},$scope.loadMoreData=function(){
$scope.pageNumber=$scope.pageNumber+1,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.loadDataByPageNumber=function(pageNumber){var res=WebService.getContent(tsIdLogin,0,8,pageNumber,$scope.typeid);$scope.loadState=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;$scope.loadState=0,length<6&&($scope.loadState=2,length<=0)||($scope.items_video=$scope.items_video.concat(data),$ionicScrollDelegate.resize())})}}),angular.module("app.controllers").controller("ChildMusicCtrl",function($scope,$state,WebService,$ionicScrollDelegate,$ionicPopup,CommonService){$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&幼儿听听*search_Audio",MobclickAgent.onPageBegin("ChildMusic")):0==platFlag&&(change_tb.setToolBar("mediaplay"),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("ChildMusic"))}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("ChildMusic"):0==platFlag&&MobclickAgent.onPageEnd("ChildMusic")}),$scope.tabCur=0,$scope.changeTab=function(index){$scope.tabCur=index},$scope.goBack=function(){$state.go("paradiseHome")},$scope.goSearch_Audio=function(){$state.go("search_Audio")},$scope.init=function(){$scope.pageNumber=1,$scope.loadState=0,$scope.items_audio=[],$scope.loadDataByPageNumber($scope.pageNumber),$scope.loadClassify()},$scope.playAudio=function(item){$state.go("audioPlay",{themeid:item.id,resourceid:null})},$scope.loadMoreData=function(){$scope.pageNumber=$scope.pageNumber+1,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.loadDataByPageNumber=function(pageNumber){var res=WebService.getContent(tsIdLogin,1,6,pageNumber);$scope.loadState=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;$scope.loadState=0,length<6&&($scope.loadState=2,length<=0)||($scope.items_audio=$scope.items_audio.concat(data),$ionicScrollDelegate.resize())})},$scope.goAudioSort=function(item){$state.go("childMusic_Sort",{typeid:item.id,typename:item.name})},$scope.loadClassify=function(){var res=WebService.getClassify(tsIdLogin,1);res.$promise.then(function(response){var data=response.data.data,length=data.length;return length<=0?void CommonService.showAlert.show("无分类数据！"):($scope.items_audioSort=data,void $ionicScrollDelegate.resize())})},$scope.init()}),angular.module("app.controllers").controller("ChildMusic_SortCtrl",function($scope,$state,$stateParams,WebService,$ionicScrollDelegate){$scope.$on("$ionicView.beforeEnter",function(){$scope.typeid=$stateParams.typeid,$scope.typename=$stateParams.typename,1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&"+$scope.typename+"*null",MobclickAgent.onPageBegin("ChildMusic_Sort")):0==platFlag&&(change_tb.setClassCauseTitle($scope.typename),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("ChildMusic_Sort")),$scope.init()}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("ChildMusic_Sort"):0==platFlag&&MobclickAgent.onPageEnd("ChildMusic_Sort")}),$scope.goBack=function(){window.history.back()},$scope.init=function(){$scope.items_audio=[],$scope.pageNumber=1,$scope.loadState=0,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.playAudio=function(item){$state.go("audioPlay",{themeid:item.id,resourceid:null})},$scope.loadMoreData=function(){$scope.pageNumber=$scope.pageNumber+1,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.loadDataByPageNumber=function(pageNumber){var res=WebService.getContent(tsIdLogin,1,8,pageNumber,$scope.typeid);$scope.loadState=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;$scope.loadState=0,length<6&&($scope.loadState=2,length<=0)||($scope.items_audio=$scope.items_audio.concat(data),$ionicScrollDelegate.resize())})}}),angular.module("app.controllers").controller("VideoPlayCtrl",function($scope,$state,$stateParams,$ionicHistory,$ionicPopup,$ionicScrollDelegate,WebService,CommonService){function resizeSetVideoBox(){var length=$scope.items_play.length,width=117*length;$(".SetVideoBox").width(width)}var myVideo=document.getElementById("videoPlayerMy");$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&null*null",MobclickAgent.onPageBegin("VideoPlay")):0==platFlag&&(change_tb.setToolBar("video"),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("VideoPlay")),$scope.themeid=$stateParams.themeid,$scope.resourceidFrom=$stateParams.resourceid,$scope.init()}),$scope.$on("$ionicView.beforeLeave",function(){myVideo.pause(),myVideo.src="",1==platFlag?MobclickAgent.onPageEnd("VideoPlay"):0==platFlag&&MobclickAgent.onPageEnd("VideoPlay")}),$scope.goBack=function(){window.history.back()},$scope.init=function(){$scope.loadingTextShow=0,$scope.loadingTextError=0,$scope.getSetByThemeId($scope.themeid,!1),$scope.current={},$scope.items_video=[],$scope.getRecomForyou();var screenWidth=window.screen.width,vHeight=9*screenWidth/16;$(".videoPlayer").height(vHeight),$("#videoPlayerMy").height(vHeight),$(".videoPanel").css("top",vHeight),$scope.currentUser={},$scope.getTsInfo()},$scope.getSetByThemeId=function(themeid,fromRecom){var res=WebService.getContentInfo(tsIdLogin,themeid);res.$promise.then(function(response){var data=response.data.data,length=data.length;return length<=0?void CommonService.showAlert.show("无选集数据！"):($scope.items_play=data,resizeSetVideoBox(),void(fromRecom?$scope.playVideoByIndex(0):$scope.resourceidFrom?$.each($scope.items_play,function(ind,el){if(el.id==$scope.resourceidFrom){var index=ind;$scope.playVideoByIndex(index)}}):$scope.playVideoByIndex(0)))})},myVideo.addEventListener("canplay",function(){$scope.loadingTextShow=0,$scope.loadingTextError=0,$scope.$digest(),myVideo.play()},!1),myVideo.addEventListener("loadstart",function(){$scope.loadingTextShow=1,$scope.loadingTextError=0,$scope.$digest()},!1),myVideo.addEventListener("error",function(){$scope.loadingTextShow=0,$scope.loadingTextError=1,$scope.$digest()},!1),$scope.playVideoByIndex=function(index){myVideo.src=$scope.items_play[index].resourceUrl,myVideo.load(),$scope.currentIndex=index,$scope.current.title=$scope.items_play[index].name,$scope.items_play[index].pv=$scope.items_play[index].pv+1,$scope.current.count=$scope.items_play[index].pv,$scope.current.resourceid=$scope.items_play[index].id,$scope.current.beriefe=$scope.items_play[index].description,CommonService.playHisService.addVideoHis($scope.items_play[index]),$scope.items_play[index].attentionid?$scope.current.storeActive=!0:$scope.current.storeActive=!1,$scope.items_play[index].praiseid?$scope.current.praiseActive=!0:$scope.current.praiseActive=!1;var resPv=WebService.updateResourcePv($scope.current.resourceid);resPv.$promise.then(function(response){response.data}),$scope.items_comment=[],$scope.pageNumber=1,$scope.loadState=0,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.togglePinch=function(){$(".videoCont").toggleClass("pinch")},$scope.getRecomForyou=function(){var res=WebService.getRecommenda(tsIdLogin,4,0);res.$promise.then(function(response){var data=response.data.data,length=data.length;return length<=0?void CommonService.showAlert.show("无为你推荐数据！"):void($scope.items_video=data)})},$scope.changePlayByThemeid=function(item){$scope.getSetByThemeId(item.id,!0)},$scope.store=function(){if($scope.current.storeActive)var cancel=2;else var cancel=1;var res=WebService.subAttention(tsIdLogin,$scope.current.resourceid,cancel);res.$promise.then(function(response){var data=response.data;0==data.code?(CommonService.showAlert.show(data.data),$scope.current.storeActive?($scope.current.storeActive=!1,$scope.items_play[$scope.currentIndex].attentionid=!1):($scope.current.storeActive=!0,$scope.items_play[$scope.currentIndex].attentionid=!0)):CommonService.showAlert.show(data.data)})},$scope.praise=function(){if($scope.current.praiseActive)var cancel=2;else var cancel=1;var res=WebService.subPraise(tsIdLogin,$scope.current.resourceid,cancel);res.$promise.then(function(response){var data=response.data;0==data.code?(CommonService.showAlert.show(data.data),$scope.current.praiseActive?($scope.current.praiseActive=!1,$scope.items_play[$scope.currentIndex].praiseid=!1):($scope.current.praiseActive=!0,$scope.items_play[$scope.currentIndex].praiseid=!0)):CommonService.showAlert.show(data.data)})},$scope.subComment=function(commentWord){var res=WebService.subComment($scope.current.resourceid,tsIdLogin,commentWord);res.$promise.then(function(response){var data=response.data;if(0==data.code){CommonService.showAlert.show(data.data);var tempComment={tsImgurl:$scope.currentUser.imgUrl,tsType:$scope.currentUser.role_type,tsName:$scope.currentUser.ts_name,date:"刚刚",content:commentWord};$scope.items_comment.unshift(tempComment),$scope.commentWord=null,$(".inputBox input").val("")}else CommonService.showAlert.show(data.data)})},$scope.scrollToUp=function(){$scope.positionOrigin=$(".videoPanel .scroll").css("transform");var hight=$(".videoPanel .videoCont").height()+30+$(".videoPanel .SetBox").height()+22+$(".videoPanel .SelContent.RecomForYou").height()+53,toUp="translate3d( 0px,-"+hight+"px,0 ) scale( 1 )";$(".videoPanel>.scroll").css("transform",toUp)},$scope.scrollBack=function(){$(".videoPanel>.scroll").css("transform",$scope.positionOrigin)},$scope.getTsInfo=function(){var res=WebService.getTsInfo(tsIdLogin);res.$promise.then(function(response){var data=response.data;0==data.code?$scope.currentUser=data.data:CommonService.showAlert.show(data.data)})},$scope.loadMoreData=function(){$scope.pageNumber=$scope.pageNumber+1,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.loadDataByPageNumber=function(pageNumber){var res=WebService.getCommentList($scope.current.resourceid,20,pageNumber);$scope.loadState=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;$scope.loadState=0,length<20&&($scope.loadState=2,length<=0)||($scope.items_comment=$scope.items_comment.concat(data),$ionicScrollDelegate.resize())})}}),angular.module("app.controllers").controller("AudioPlayCtrl",function($scope,$state,$stateParams,$ionicHistory,$ionicPopup,WebService,CommonService){$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&null*null",MobclickAgent.onPageBegin("AudioPlay")):0==platFlag&&(change_tb.setToolBar("mediaplaying"),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("AudioPlay")),$scope.themeid=$stateParams.themeid,$scope.resourceidFrom=$stateParams.resourceid,$scope.currentIndex=0,$scope.listLength=0,$scope.songPlaying=0,$scope.showPlaylist=0,$scope.circleMode=0,$scope.items_audio=[],$scope.loadingTextShow=0,$scope.loadingTextError=0,$scope.canPlay=0,$scope.myAudio=document.getElementById("audioPlayerHide"),$scope.myAudio.autoplay=!1;var res=WebService.getContentInfo(tsIdLogin,$scope.themeid);res.$promise.then(function(response){var data=response.data.data,length=data.length;return length<=0?void CommonService.showAlert.show("无曲目信息"):($scope.items_audio=data,$scope.listLength=length,$scope.myAudio.addEventListener("canplay",function(){$scope.loadingTextShow=0,$scope.loadingTextError=0,$scope.canPlay=1,$scope.firstSong?$scope.songPlaying=0:($scope.myAudio.play(),$scope.songPlaying=1),$scope.$digest()},!1),$scope.myAudio.addEventListener("loadstart",function(){$scope.loadingTextShow=1,$scope.loadingTextError=0,$scope.canPlay=0,$scope.songPlaying=2,$scope.$digest()},!1),$scope.myAudio.addEventListener("error",function(){$scope.loadingTextShow=0,$scope.loadingTextError=1,$scope.$digest()},!1),$scope.myAudio.addEventListener("ended",function(){if($scope.songPlaying=0,$scope.$digest(),0==$scope.circleMode)$scope.currentIndex<$scope.listLength-1?$scope.playSongByIndex($scope.currentIndex+1):$scope.playSongByIndex(0);else if(1==$scope.circleMode)$scope.playSongByIndex($scope.currentIndex);else{var indexTemp=Math.floor($scope.currentIndex+$scope.listLength*Math.random());indexTemp>$scope.listLength-1?$scope.playSongByIndex(indexTemp-($scope.listLength-1)):$scope.playSongByIndex(indexTemp)}}),void($scope.resourceidFrom?$.each($scope.items_audio,function(ind,el){if(el.id==$scope.resourceidFrom){var index=ind;$scope.playFirstSong(index)}}):$scope.playFirstSong(0)))})}),$scope.$on("$ionicView.beforeLeave",function(){$scope.myAudio.pause(),$scope.myAudio.src="",1==platFlag?MobclickAgent.onPageEnd("AudioPlay"):0==platFlag&&MobclickAgent.onPageEnd("AudioPlay")}),$scope.playFirstSong=function(index){$scope.firstSong=!0,$scope.currentIndex=index;var audioSrc=$scope.items_audio[index].resourceUrl;$scope.myAudio.src=audioSrc,$scope.myAudio.load(),$scope.audioNameCurrent=$scope.items_audio[index].name,$scope.audioImageCurrent=$scope.items_audio[index].imgUrl,$scope.audioLrcCurrent=$scope.items_audio[index].content,CommonService.playHisService.addAudioHis($scope.items_audio[index]);var resPv=WebService.updateResourcePv($scope.items_audio[index].id);resPv.$promise.then(function(response){response.data})},$scope.playSongByIndex=function(index){$scope.firstSong=!1,$scope.currentIndex=index;var audioSrc=$scope.items_audio[index].resourceUrl;$scope.myAudio.src=audioSrc,$scope.audioNameCurrent=$scope.items_audio[index].name,$scope.audioImageCurrent=$scope.items_audio[index].imgUrl,$scope.audioLrcCurrent=$scope.items_audio[index].content,$scope.myAudio.load(),$scope.showPlaylist=0,CommonService.playHisService.addAudioHis($scope.items_audio[index]);var resPv=WebService.updateResourcePv($scope.items_audio[index].id);resPv.$promise.then(function(response){response.data})},$scope.playPreviousSong=function(){if(0==$scope.circleMode||1==$scope.circleMode)$scope.currentIndex>0?$scope.playSongByIndex($scope.currentIndex-1):$scope.playSongByIndex($scope.listLength-1);else{var indexTemp=Math.floor($scope.currentIndex-$scope.listLength*Math.random());indexTemp<0?$scope.playSongByIndex($scope.listLength-1+indexTemp):$scope.playSongByIndex(indexTemp)}},$scope.playNextSong=function(){if(0==$scope.circleMode||1==$scope.circleMode)$scope.currentIndex<$scope.listLength-1?$scope.playSongByIndex($scope.currentIndex+1):$scope.playSongByIndex(0);else{var indexTemp=Math.floor($scope.currentIndex+$scope.listLength*Math.random());indexTemp>$scope.listLength-1?$scope.playSongByIndex(indexTemp-($scope.listLength-1)):$scope.playSongByIndex(indexTemp)}},$scope.onSwipeLeft=function(){$scope.playPreviousSong()},$scope.onSwipeRight=function(){$scope.playNextSong()},$scope.playOrpause=function(){if(0==$scope.songPlaying)$scope.myAudio.play(),$scope.songPlaying=1;else{if(1!=$scope.songPlaying)return;$scope.myAudio.pause(),$scope.songPlaying=0}},$scope.changeCircleMode=function(){0==$scope.circleMode?$scope.circleMode=1:1==$scope.circleMode?$scope.circleMode=2:$scope.circleMode=0},$scope.lrcFull=0,$scope.showSrcTxt="查看歌词",$scope.toggleLrc=function(){0==$scope.lrcFull?($scope.lrcFull=1,$scope.showSrcTxt="返回"):($scope.lrcFull=0,$scope.showSrcTxt="查看歌词")},$scope.togglePlaylist=function(){0==$scope.showPlaylist?$scope.showPlaylist=1:$scope.showPlaylist=0},$scope.goBack=function(){window.history.back()},$scope.store=function(index){var resourceidS=$scope.items_audio[index].id;if($scope.items_audio[index].attentionid)var cancel=2;else var cancel=1;var res=WebService.subAttention(tsIdLogin,resourceidS,cancel);res.$promise.then(function(response){var data=response.data;0==data.code?(CommonService.showAlert.show(data.data),$scope.items_audio[index].attentionid?$scope.items_audio[index].attentionid=null:$scope.items_audio[index].attentionid=!0):CommonService.showAlert.show(data.data)})}}),angular.module("app.controllers").controller("EduInformationCtrl",function($scope,$rootScope,$state,WebService){$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&教育资讯*search_Inf",MobclickAgent.onPageBegin("EduInformation")):0==platFlag&&(change_tb.setToolBar("consult"),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("EduInformation")),$rootScope.eduReLoad&&($scope.$broadcast("getInEduInformation"),$rootScope.eduReLoad=!1)}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("EduInformation"):0==platFlag&&MobclickAgent.onPageEnd("EduInformation")}),$scope.tabCur=0,$scope.changeTab=function(index){$scope.tabCur=index},$scope.goBack=function(){$state.go("paradiseHome")},$scope.goSearch_Inf=function(){$state.go("search_Inf")}}).controller("InfSort0Ctrl",function($scope,$state,WebService,$ionicScrollDelegate){$scope.$on("getInEduInformation",function(){$scope.init()}),$scope.init=function(){$scope.items_inf=[],$scope.pageNumber=1,$scope.loadState=0,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.doRefresh=function(){$scope.init()},$scope.$on("ajaxError",function(){$scope.$broadcast("scroll.refreshComplete")}),$scope.showInfDet=function(item){$state.go("eduInformation_Detail",{resourceid:item.id})},$scope.loadMoreData=function(){$scope.pageNumber=$scope.pageNumber+1,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.loadDataByPageNumber=function(pageNumber){var res=WebService.getContent(tsIdLogin,2,6,pageNumber,201);$scope.loadState=1,res.$promise.then(function(response){(pageNumber=1)&&$scope.$broadcast("scroll.refreshComplete");var data=response.data.data,length=data.length;$scope.loadState=0,length<6&&($scope.loadState=2,length<=0)||($scope.items_inf=$scope.items_inf.concat(data),$ionicScrollDelegate.resize())})}}).controller("InfSort1Ctrl",function($scope,$state,WebService,$ionicScrollDelegate){$scope.$on("getInEduInformation",function(){$scope.init()}),$scope.init=function(){$scope.items_inf=[],$scope.pageNumber=1,$scope.loadState=0,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.doRefresh=function(){$scope.init()},$scope.$on("ajaxError",function(){$scope.$broadcast("scroll.refreshComplete")}),$scope.showInfDet=function(item){$state.go("eduInformation_Detail",{resourceid:item.id})},$scope.loadMoreData=function(){$scope.pageNumber=$scope.pageNumber+1,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.loadDataByPageNumber=function(pageNumber){var res=WebService.getContent(tsIdLogin,2,6,pageNumber,202);$scope.loadState=1,res.$promise.then(function(response){(pageNumber=1)&&$scope.$broadcast("scroll.refreshComplete");var data=response.data.data,length=data.length;$scope.loadState=0,length<6&&($scope.loadState=2,length<=0)||($scope.items_inf=$scope.items_inf.concat(data),$ionicScrollDelegate.resize())})}}).controller("InfSort2Ctrl",function($scope,$state,WebService,$ionicScrollDelegate){$scope.$on("getInEduInformation",function(){$scope.init()}),$scope.init=function(){$scope.items_inf=[],$scope.pageNumber=1,$scope.loadState=0,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.doRefresh=function(){$scope.init()},$scope.$on("ajaxError",function(){$scope.$broadcast("scroll.refreshComplete")}),$scope.showInfDet=function(item){$state.go("eduInformation_Detail",{resourceid:item.id})},$scope.loadMoreData=function(){$scope.pageNumber=$scope.pageNumber+1,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.loadDataByPageNumber=function(pageNumber){var res=WebService.getContent(tsIdLogin,2,6,pageNumber,204);$scope.loadState=1,res.$promise.then(function(response){(pageNumber=1)&&$scope.$broadcast("scroll.refreshComplete");var data=response.data.data,length=data.length;$scope.loadState=0,length<6&&($scope.loadState=2,length<=0)||($scope.items_inf=$scope.items_inf.concat(data),$ionicScrollDelegate.resize())})}}).controller("InfSort3Ctrl",function($scope,$state,WebService,$ionicScrollDelegate){$scope.$on("getInEduInformation",function(){$scope.init()}),$scope.init=function(){$scope.items_inf=[],$scope.pageNumber=1,$scope.loadState=0,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.doRefresh=function(){$scope.init()},$scope.$on("ajaxError",function(){$scope.$broadcast("scroll.refreshComplete")}),$scope.showInfDet=function(item){$state.go("eduInformation_Detail",{resourceid:item.id})},$scope.loadMoreData=function(){$scope.pageNumber=$scope.pageNumber+1,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.loadDataByPageNumber=function(pageNumber){var res=WebService.getContent(tsIdLogin,2,6,pageNumber,203);$scope.loadState=1,res.$promise.then(function(response){(pageNumber=1)&&$scope.$broadcast("scroll.refreshComplete");var data=response.data.data,length=data.length;$scope.loadState=0,length<6&&($scope.loadState=2,length<=0)||($scope.items_inf=$scope.items_inf.concat(data),$ionicScrollDelegate.resize())})}}),angular.module("app.controllers").controller("EduInformation_DetailCtrl",function($scope,$state,$stateParams,$ionicHistory,WebService,CommonService){$scope.$on("$ionicView.beforeEnter",function(){1==platFlag?(window.location.href="tooc://changenavigationtitle:?null&null*null",MobclickAgent.onPageBegin("EduInformation_Detail")):0==platFlag&&(change_tb.setToolBar("consultDetail"),change_tb.sendBroadcast(!1),MobclickAgent.onPageBegin("EduInformation_Detail")),$scope.resourceid=$stateParams.resourceid,$scope.init()}),$scope.$on("$ionicView.beforeLeave",function(){1==platFlag?MobclickAgent.onPageEnd("EduInformation_Detail"):0==platFlag&&MobclickAgent.onPageEnd("EduInformation_Detail")}),$scope.init=function(){var res=WebService.getResourceDetail(tsIdLogin,$scope.resourceid);res.$promise.then(function(response){var data=response.data.data;return data?($scope.displayInfName=data.name,$scope.displayInfCnt=data.content,$scope.displaySource=data.source,$scope.displayCreatetime=data.createtime,data.attentionid?$scope.storeActive=!0:$scope.storeActive=!1,void CommonService.playHisService.addInfHis(data)):void CommonService.showAlert.show("无资讯数据！")});var resPv=WebService.updateResourcePv($scope.resourceid);resPv.$promise.then(function(response){response.data}),$scope.currentUser={},$scope.getTsInfo(),$scope.items_comment=[],$scope.pageNumber=1,$scope.loadState=0,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.goBack=function(){$ionicHistory.goBack()},$scope.store=function(){if($scope.storeActive)var cancel=2;else var cancel=1;var res=WebService.subAttention(tsIdLogin,$scope.resourceid,cancel);res.$promise.then(function(response){var data=response.data;0==data.code?(CommonService.showAlert.show(data.data),$scope.storeActive?($scope.storeActive=!1,data.attentionid=!1):($scope.storeActive=!0,data.attentionid=!0)):CommonService.showAlert.show(data.data)})},$scope.subComment=function(commentWord){var res=WebService.subComment($scope.resourceid,tsIdLogin,commentWord);res.$promise.then(function(response){var data=response.data;if(0==data.code){CommonService.showAlert.show(data.data);var tempComment={tsImgurl:$scope.currentUser.imgUrl,tsType:$scope.currentUser.role_type,tsName:$scope.currentUser.ts_name,date:"刚刚",content:commentWord};$scope.items_comment.unshift(tempComment),$scope.commentWord=null,$(".inputBox input").val("")}else CommonService.showAlert.show(data.data)})},$scope.scrollToUp=function(){$scope.positionOrigin=$(".InfDetContent.eduInf>.scroll").css("transform");var hight=$(".InfDetContent.eduInf .InfDetContent").height()+60,toUp="translate3d( 0px,-"+hight+"px,0 ) scale( 1 )";$(".InfDetContent.eduInf>.scroll").css("transform",toUp)},$scope.scrollBack=function(){$(".InfDetContent.eduInf>.scroll").css("transform",$scope.positionOrigin)},$scope.getTsInfo=function(){var res=WebService.getTsInfo(tsIdLogin);res.$promise.then(function(response){var data=response.data;0==data.code?$scope.currentUser=data.data:CommonService.showAlert.show(data.data)})},$scope.loadMoreData=function(){$scope.pageNumber=$scope.pageNumber+1,$scope.loadDataByPageNumber($scope.pageNumber)},$scope.loadDataByPageNumber=function(pageNumber){var res=WebService.getCommentList($scope.resourceid,20,pageNumber);$scope.loadState=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;$scope.loadState=0,length<20&&($scope.loadState=2,length<=0)||($scope.items_comment=$scope.items_comment.concat(data),$ionicScrollDelegate.resize())})}});