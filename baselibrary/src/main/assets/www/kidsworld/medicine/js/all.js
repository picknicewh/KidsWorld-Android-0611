"use strict";angular.module("app.constants",[]).constant("BASE_URL","http://eduslb.openhunme.com/KidsWorld");
"use strict";angular.module("app.services",[]);
"use strict";angular.module("app.directives",[]);
"use strict";angular.module("app.filters",[]),angular.module("app.filters").filter("numberTo4",function(){return function(input){if(input){if(input>=1e3){var newNum=(input/1e4).toFixed(1);return newNum+"万"}return input}return 0}}),angular.module("app.filters").filter("timeToMinute",function(){return function(input){return input?input.substring(5,16):""}}),angular.module("app.filters").filter("dataTime",function(){return function(input){return input.slice(0,10)}});

"use strict";angular.module("app.controllers",[]);
"use strict";angular.module("app",["ui.router","ngAnimate","ionic","app.services","app.controllers","app.constants","app.directives","app.filters"]).run(function($rootScope,$state){function onDeviceReady(){}$rootScope.$on("$stateChangeStart",function(event,next){}),document.addEventListener("deviceready",onDeviceReady,!1)}).config(function($stateProvider,$urlRouterProvider,$ionicConfigProvider){$ionicConfigProvider.views.maxCache(1),$stateProvider.state("medicineEntrust",{url:"/medicineEntrust",templateUrl:"views/medicineEntrust.html",controller:"medicineEntrustCtrl"}).state("medicineListP",{url:"/medicineListP",templateUrl:"views/medicineListP.html",controller:"medicineListPCtrl"}).state("medicineListT",{url:"/medicineListT",templateUrl:"views/medicineListT.html",controller:"medicineListTCtrl"}).state("medicineTask",{url:"/medicineTask?medicineId&status",templateUrl:"views/medicineTask.html",controller:"medicineTaskCtrl"})});
angular.module("app.services").factory("AjaxService",function($http,$httpParamSerializerJQLike,$q,$ionicLoading,CommonService,BASE_URL,$rootScope){return{ajax:function(options){var url=options.url;options.useBaseUrl&&(url=BASE_URL+options.url);var httpOption={method:options.type||"post",url:url};if("post"==httpOption.method)httpOption.data=options.data||{};else{var pString=$httpParamSerializerJQLike(options.data||{});httpOption.url+=pString?"?"+pString:""}var deferred=$q.defer();return"post"==httpOption.method?$.ajax({type:"post",url:httpOption.url,data:httpOption.data,dataType:"json",success:function(data){return data.code==-9?void CommonService.showAlert.show("系统繁忙"):void deferred.resolve({data:data})},error:function(data){CommonService.showAlert.show("请求失败"),$rootScope.$broadcast("ajaxError"),deferred.reject(data)}}):$http(httpOption).success(function(data,status,header,config){return data.code==-9?void CommonService.showAlert.show("系统繁忙"):void deferred.resolve({data:data})}).error(function(data,status,header,config){CommonService.showAlert.show("请求失败"),$rootScope.$broadcast("ajaxError"),deferred.reject(data)}),{$promise:deferred.promise}}}});
angular.module("app.services").factory("WebService",function(AjaxService){return{getMedicineP:function(tsId,pageNumber,pageSize){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/school/patriarchFeedingMedicine.do",options.data={tsId:tsId,pageNumber:pageNumber,pageSize:pageSize},AjaxService.ajax(options)},delEntrust:function(tsId,medicineId){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/school/deleteMedicine.do",options.data={tsId:tsId,medicineId:medicineId},AjaxService.ajax(options)},getMedicineT:function(tsId){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/school/teacherFeedingMedicine.do",options.data={tsId:tsId},AjaxService.ajax(options)},getMedicineTaskDetails:function(medicineId){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/school/medicineDetails.do",options.data={medicineId:medicineId},AjaxService.ajax(options)},finishedMedicine:function(tsId,medicineId){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/school/finishMedicine.do",options.data={tsId:tsId,medicineId:medicineId},AjaxService.ajax(options)},submitEnturst:function(data){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/school/publishMedicineCommissioned.do",options.data=data,AjaxService.ajax(options)},getHomeBanner:function(tsId){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getBanner.do",options.data={tsId:tsId},AjaxService.ajax(options)},getRecommenda:function(tsId,size,type){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getRecommenda.do",options.data={tsId:tsId,size:size,type:type},AjaxService.ajax(options)},getIndexAllRecommenda:function(tsId,size){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getIndexAllRecommenda.do",options.data={tsId:tsId,size:size},AjaxService.ajax(options)},getContent:function(tsId,type,pageSize,pageNumber,typeid){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getContent.do",options.data={tsId:tsId,type:type,pageSize:pageSize,pageNumber:pageNumber,typeid:typeid},AjaxService.ajax(options)},getClassify:function(tsId,type){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getClassify.do",options.data={tsId:tsId,type:type},AjaxService.ajax(options)},getContentInfo:function(tsId,themeid){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getContentInfo.do",options.data={tsId:tsId,themeid:themeid},AjaxService.ajax(options)},subAttention:function(tsId,resourceid,cancel){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/subAttention.do",options.data={tsId:tsId,resourceid:resourceid,cancel:cancel},AjaxService.ajax(options)},subPraise:function(tsId,resourceid,cancel){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/subPraise.do",options.data={tsId:tsId,resourceid:resourceid,cancel:cancel},AjaxService.ajax(options)},getResourceListByName:function(name,type,pageSize,pageNumber){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getResourceListByName.do",options.data={name:name,type:type,pageSize:pageSize,pageNumber:pageNumber},AjaxService.ajax(options)},getMyAttentionResourceList:function(tsId,type,pageSize,pageNumber){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getMyAttentionResourceList.do",options.data={tsId:tsId,type:type,pageSize:pageSize,pageNumber:pageNumber},AjaxService.ajax(options)},getResourceDetail:function(tsId,resourceid){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getResourceDetail.do",options.data={tsId:tsId,resourceid:resourceid},AjaxService.ajax(options)},updateResourcePv:function(resourceid){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/updateResourcePv",options.data={resourceid:resourceid},AjaxService.ajax(options)},subComment:function(resourceid,tsId,content){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/subComment",options.data={resourceid:resourceid,tsId:tsId,content:content},AjaxService.ajax(options)},getCommentList:function(resourceid,pageSize,pageNumber){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getCommentList",options.data={resourceid:resourceid,pageSize:pageSize,pageNumber:pageNumber},AjaxService.ajax(options)},getTsInfo:function(tsId){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/rakuen/getTsInfo",options.data={tsId:tsId},AjaxService.ajax(options)}}});
angular.module("app.services").factory("CommonService",function(){return{showAlert:{cfg:{id:".kBubble",speed:2e3},show:function(str){var oBubble=$(this.cfg.id);oBubble.length||(oBubble=$('<div class="kBubble" />').appendTo($("body")),oBubble.html(str).fadeIn()),setTimeout("$('.kBubble').fadeOut('slow',function(){$('.kBubble').remove();})",this.cfg.speed)}},showAlert1:{cfg:{id:".kBubble",speed:1e3},show:function(str){var oBubble=$(this.cfg.id);oBubble.length||(oBubble=$('<div class="kBubble" />').appendTo($("body")),oBubble.html(str).fadeIn()),setTimeout("$('.kBubble').fadeOut('slow',function(){$('.kBubble').remove();})",this.cfg.speed)}}}});

angular.module("app.controllers").controller("medicineEntrustCtrl",function($scope,$state,$ionicPopup,WebService,CommonService){$scope.goBack=function(){$state.go("medicineListP")},$scope.$on("$ionicView.beforeEnter",function(){$scope.param={},MobclickAgent.onPageBegin("medicineEntrust")}),$scope.$on("$ionicView.beforeLeave",function(){MobclickAgent.onPageEnd("medicineEntrust")}),$scope.$on("$ionicView.afterEnter",function(){var input1=document.getElementById("input1");new mCalendar({multiple:!0,toBind:input1,callback:function(){$scope.param.selectedDate=this.outputDate,0!==this.outputDate.length?$scope.param.status=0:$scope.param.status=1,$scope.$digest()}});$scope.toggleRadio=function(event){$(event.target).addClass("on").siblings().removeClass("on")},$scope.toggleInput=function(event){$(event.target).parent().addClass("on").siblings().removeClass("on")}}),$scope.submitData=function(){var medicineTime=$(".radio_meal.on").children("input").val(),selectedDate=$scope.param.selectedDate;selectedDate=1==selectedDate.length?selectedDate.join():selectedDate.replace(/\s/gi,"");var data={createTime:selectedDate,medicineName:$scope.param.medicineName,medicineDosage:$scope.param.medicineCounts,medicineDoc:$scope.param.remark,mealBeforeOrAfter:medicineTime,tsId:tsIdLogin},res=WebService.submitEnturst(data);res.$promise.then(function(response){response&&0==response.data.code?$state.go("medicineListP"):CommonService.showAlert.show("提交失败！请重新提交")})},$scope.scrollToUp=function(){$scope.positionOrigin=$(".hasBottomButton>.scroll").css("transform");var toUp="translate3d( 0px,-300px,0 ) scale( 1 )";$(".hasBottomButton>.scroll").css("transform",toUp)},$scope.scrollBack=function(){$(".hasBottomButton>.scroll").css("transform",$scope.positionOrigin)}});
angular.module("app.controllers").controller("medicineListPCtrl",function($scope,$state,$ionicScrollDelegate,$ionicPopup,WebService){function getData(pageNumber){var res=WebService.getMedicineP(tsIdLogin,pageNumber,pageSize);$scope.loadState=1,res.$promise.then(function(response){if($scope.pro1=!1,$scope.loadState=0,response&&0==response.data.code){var data1=response.data.data.medicineList,data2=response.data.data.medicineScheduleJson,length1=data1.length,length2=data2.length;if(length2>0?($scope.pro=!1,$scope.item2=$scope.item2.concat(data2)):$scope.pro=!0,length1<pageSize&&($scope.loadState=2,length1<=0))return void((pageNumber=1)&&($scope.loadState=3,$scope.pro1=!0));$scope.item1=$scope.item1.concat(data1),$ionicScrollDelegate.resize()}else $scope.loadState=2,$scope.pro=!0})}function del(index,medicineId){var res=WebService.delEntrust(tsIdLogin,medicineId);res.$promise.then(function(response){response&&0==response.data.code?$scope.item1.splice(index,1):CommonService.showAlert("操作失败")})}var pageSize=10,pageNumber=1;$scope.$on("$ionicView.beforeEnter",function(){$scope.item1=[],$scope.item2=[],$scope.loadState=0,$scope.pro=!1,getData(pageNumber),MobclickAgent.onPageBegin("medicineListP")}),$scope.$on("$ionicView.beforeLeave",function(){MobclickAgent.onPageEnd("medicineListP")}),$scope.tabCur=0,$scope.changeTab=function(index){$scope.tabCur=index},$scope.onSwipeTo=function(index){$scope.tabCur=index},$scope.loadMoreData=function(){pageNumber++,getData(pageNumber)},$scope.toDetails=function(medicineId,status){$state.go("medicineTask",{medicineId:medicineId,status:status})},$scope.showConfirm=function(index,medicineId){var confirmPopup=$ionicPopup.confirm({title:"确认删除吗",cancelText:"取消",okText:"确定"});confirmPopup.then(function(res){res?del(index,medicineId):console.log("You are not sure")})},$scope.goBack=function(){if(0==platFlag)change_tb.back();else{if(1!=platFlag)return;OCdynamicId.iosUsercomment("userBack")}},$scope.toEntrust=function(){$state.go("medicineEntrust")}});
angular.module("app.controllers").controller("medicineListTCtrl",function($scope,$state,$ionicPopup,WebService){function getData(){var data1="",data2="",res=WebService.getMedicineT(tsIdLogin);res.$promise.then(function(response){0==response.data.code&&(data1=response.data.data.notMedicine,data2=response.data.data.finishMedicine,$scope.item1=data1,$scope.item2=data2)})}$scope.item1=[],$scope.item2=[],$scope.goBack=function(){if(0==platFlag)change_tb.back();else{if(1!=platFlag)return;OCdynamicId.iosUsercomment("userBack")}},$scope.$on("$ionicView.beforeEnter",function(){getData(),MobclickAgent.onPageBegin("medicineListT")}),$scope.$on("$ionicView.beforeLeave",function(){MobclickAgent.onPageEnd("medicineListT")}),$scope.toDetails=function(medicineId,status){$state.go("medicineTask",{medicineId:medicineId,status:status})}});
angular.module("app.controllers").controller("medicineTaskCtrl",function($scope,$state,$ionicPopup,$stateParams,$ionicHistory,WebService,CommonService){function getData(medId){var data="",res=WebService.getMedicineTaskDetails(medId);res.$promise.then(function(response){if(data=response.data.data,0==response.data.code){var temp="",timeList=data.medicineStatusList;if(timeList&&0!==timeList.length){if(1==timeList.length)temp=timeList[0].create_time.slice(0,10);else for(var i in timeList)temp+=i==timeList.length-1?timeList[i].create_time.slice(0,10):timeList[i].create_time.slice(0,10)+";   ";data.medicineStatusList=temp}$scope.item=data}})}$scope.$on("$ionicView.beforeEnter",function(){$scope.medicineId=$stateParams.medicineId,$scope.status=$stateParams.status,$scope.item=[],getData($scope.medicineId),MobclickAgent.onPageBegin("medicineTask")}),$scope.$on("$ionicView.beforeLeave",function(){MobclickAgent.onPageEnd("medicineTask")}),$scope.goBack=function(){$ionicHistory.goBack()},$scope.toPerson=function(childId){if(0==platFlag)change_tb.goDetailActivity(childId);else{if(1!=platFlag)return;OCdynamicId.iosUsercomment(childId)}},$scope.finishTask=function(){var res=WebService.finishedMedicine(tsIdLogin,$scope.medicineId);res.$promise.then(function(response){response&&0==response.data.code?(CommonService.showAlert1.show("提交成功"),setTimeout(function(){$ionicHistory.goBack()},2e3)):CommonService.showAlert.show("提交失败")})}});
