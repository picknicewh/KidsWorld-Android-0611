"use strict";angular.module("app",["ui.router","ionic","ionic-datepicker","onezone-datepicker","app.filters","app.services","app.controllers","app.constants","app.directives"]).run(function($rootScope,$state){function onDeviceReady(){}$rootScope.$on("$stateChangeStart",function(event,next){}),document.addEventListener("deviceready",onDeviceReady,!1)}).config(function($stateProvider,$urlRouterProvider){$stateProvider.state("foodList",{url:"/foodList",templateUrl:"views/home/foodList.html",controller:"foodListCtrl"}).state("askForlv",{url:"/askForlv",templateUrl:"views/home/askForlv.html",controller:"askForlvCtrl"}).state("courseArr",{url:"/courseArr",templateUrl:"views/home/courseArr.html",controller:"courseArrCtrl"})});
"use strict";angular.module("app.constants",[]).constant("BASE_URL","http://eduslb.openhunme.com/KidsWorld");
"use strict";angular.module("app.services",[]);
"use strict";angular.module("app.directives",[]);
"use strict";angular.module("app.controllers",[]);
angular.module("app.controllers").controller("askForlvCtrl",function($scope,$state,$ionicScrollDelegate,$ionicPopup,$parse,NoteService,WebService,$timeout,$http){function getData(){var res=WebService.getLeaveList($scope.tsId,pageNumber,pageSize);$scope.loadState=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;if($scope.loadState=0,0==response.data.code){if(length<pageSize&&($scope.loadState=2,length<=0))return;$scope.items=$scope.items.concat(data),$ionicScrollDelegate.resize()}else $scope.loadState=2})}$scope.loadState=5;var pageNumber=1,pageSize=15;$scope.tsId=getUrlParam("tsId"),$scope.$on("$ionicView.beforeEnter",function(){$scope.items=[],getData()}),$scope.pullUp=function(){pageNumber++,getData()}});
angular.module("app.controllers").controller("courseArrCtrl",function($scope,$state,$ionicScrollDelegate,NoteService,WebService,$ionicPopup){function getData(){var res=WebService.getCourse($scope.tsId,pageNumber,pageSize);$scope.loadState=1,res.$promise.then(function(response){var data=response.data.data,length=data.length;if($scope.loadState=0,0==response.data.code){if(length<pageSize&&($scope.loadState=2,length<=0))return;$scope.items=$scope.items.concat(data),$ionicScrollDelegate.resize()}else $scope.loadState=2})}function del(index,syllabusId){var res=WebService.delteList($scope.tsId,syllabusId);res.$promise.then(function(response){data=response.data,"0"==data.code&&$scope.items.splice(index,1)})}$scope.pro=!1;var pageNumber=1,pageSize=2;$scope.imgIndex=2,$scope.tsId=getUrlParam("tsId"),$scope.type=getUrlParam("type"),$scope.$on("$ionicView.beforeEnter",function(){$scope.loadState=5,$scope.items=[],getData(),mui.previewImage()}),$scope.pullUp=function(){pageNumber++,getData()},$scope.showConfirm=function(index,syllabusId){var confirmPopup=$ionicPopup.confirm({title:"确认删除吗",cancelText:"取消",okText:"确定"});confirmPopup.then(function(res){res?del(index,syllabusId):console.log("You are not sure")})}});
angular.module("app.controllers").controller("foodListCtrl",function($scope,$state,$ionicPopup,NoteService,WebService){function getFoodList(tsId,dateKey){var res=WebService.getFoodList(tsId,dateKey);res.$promise.then(function(response){$scope.items=response.data.data.dishesList,0==$scope.items.length?$scope.pro=!0:$scope.pro=!1})}var tsId=getUrlParam("tsId");$scope.items=[];var date=new Date;$scope.$on("$ionicView.beforeEnter",function(){$scope.items=[],$scope.myFunction(date)}),Date.prototype.Format=function(fmt){var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(fmt)&&(fmt=fmt.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var k in o)new RegExp("("+k+")").test(fmt)&&(fmt=fmt.replace(RegExp.$1,1==RegExp.$1.length?o[k]:("00"+o[k]).substr((""+o[k]).length)));return fmt},$scope.myFunction=function(date){var dateString=date.Format("yyyy-MM-dd");getFoodList(tsId,dateString)},$scope.onezoneDatepicker={date:date,mondayFirst:!1,months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],daysOfTheWeek:["日","一","二","三","四","五","六"],startDate:new Date(1989,1,26),endDate:new Date(2024,1,26),disablePastDays:!1,disableSwipe:!1,disableWeekend:!1,showDatepicker:!1,showTodayButton:!0,calendarMode:!1,hideCancelButton:!1,hideSetButton:!0,callback:$scope.myFunction},$scope.showDatepicker=function(){$scope.onezoneDatepicker.showDatepicker=!0}});
"use strict";angular.module("app.controllers").controller("AppCtrl",function($scope,$state,$location,$rootScope){$scope.open=function(state,params){$state.go(state,params)}});
"use strict";angular.module("app.directives").directive("templateFooter",function(){return{restrict:"EA",templateUrl:"views/footer/tabs.html"}});
"use strict";angular.module("app.directives").directive("templateHeader",function(){return{restrict:"EA",templateUrl:"views/headers/root.html",transclude:!0,scope:!1,controller:["$scope","$state",function($scope,$state){$scope.getState=function(){return $state.current.templateUrl?"views/headers/"+$state.current.templateUrl.substring(6):"views/headers/notes/notes.list.html"}}]}});
"use strict";angular.module("app.directives").directive("touchableIcon",function(){return{restrict:"A",transclude:!1,scope:!1,link:function(scope,element,attrs){element.on("touchstart",function(){$(this).addClass("pressed-icon")}).on("touchend",function(){$(this).removeClass("pressed-icon")})}}});
"use strict";angular.module("app.filters",[]),angular.module("app.filters").filter("numberTo4",function(){return function(input){if(input>=1e3){var newNum=(input/1e4).toFixed(1);return newNum+"万"}return input}}),angular.module("app.filters").filter("dataToMinute",function(){return function(input){return input.substring(0,16)}}),angular.module("app.filters").filter("dataToday",function(){return function(input){return input.slice(0,11)}}),angular.module("app.filters").filter("dataTime",function(){return function(input){return input.slice(0,10)}});
angular.module("app.services").factory("AjaxService",function($http,$httpParamSerializerJQLike,$q,$ionicLoading,CommonService,BASE_URL,$rootScope){return{ajax:function(options){var url=options.url;options.useBaseUrl&&(url=BASE_URL+options.url);var httpOption={method:options.type||"post",url:url};if("post"==httpOption.method)httpOption.data=options.data||{};else{var pString=$httpParamSerializerJQLike(options.data||{});httpOption.url+=pString?"?"+pString:""}var deferred=$q.defer();return"post"==httpOption.method?$.ajax({type:"post",url:httpOption.url,data:httpOption.data,dataType:"json",success:function(data){deferred.resolve({data:data})},error:function(data){CommonService.showAlert.show("请求失败"),$rootScope.$broadcast("ajaxError"),deferred.reject(data)}}):$http(httpOption).success(function(data,status,header,config){deferred.resolve({data:data})}).error(function(data,status,header,config){CommonService.showAlert.show("请求失败"),$rootScope.$broadcast("ajaxError"),deferred.reject(data)}),{$promise:deferred.promise}}}});
angular.module("app.services").factory("CommonService",function(){return{showAlert:{cfg:{id:".kBubble",speed:3e3},show:function(str){var oBubble=$(this.cfg.id);oBubble.length||(oBubble=$('<div class="kBubble" />').appendTo($("body")),oBubble.html(str).fadeIn()),setTimeout(this.hide(),this.cfg.speed)},hide:function(){$(this.cfg.id).fadeOut("slow",function(){$(this).remove()})}}}});
angular.module("ionic-datepicker",["ionic","ionic-datepicker.service","ionic-datepicker.provider","ionic-datepicker.templates"]);
angular.module("ionic-datepicker.provider",[]).provider("ionicDatePicker",function(){var config={setLabel:"Set",todayLabel:"Today",closeLabel:"Close",inputDate:new Date,mondayFirst:!0,weeksList:["S","M","T","W","T","F","S"],monthsList:["Jan","Feb","March","April","May","June","July","Aug","Sept","Oct","Nov","Dec"],templateType:"popup",showTodayButton:!1,closeOnSelect:!1,disableWeekdays:[]};this.configDatePicker=function(inputObj){angular.extend(config,inputObj)},this.$get=["$rootScope","$ionicPopup","$ionicModal","IonicDatepickerService",function($rootScope,$ionicPopup,$ionicModal,IonicDatepickerService){function resetHMSM(currentDate){return currentDate.setHours(0),currentDate.setMinutes(0),currentDate.setSeconds(0),currentDate.setMilliseconds(0),currentDate}function setDisabledDates(mainObj){mainObj.disabledDates&&0!==mainObj.disabledDates.length?($scope.disabledDates=[],angular.forEach(mainObj.disabledDates,function(val,key){val=resetHMSM(new Date(val)),$scope.disabledDates.push(val.getTime())})):$scope.disabledDates=[]}function refreshDateList(currentDate){currentDate=resetHMSM(currentDate),$scope.currentDate=angular.copy(currentDate);var firstDay=new Date(currentDate.getFullYear(),currentDate.getMonth(),1).getDate(),lastDay=new Date(currentDate.getFullYear(),currentDate.getMonth()+1,0).getDate();$scope.monthsList=[],$scope.mainObj.monthsList&&12===$scope.mainObj.monthsList.length?$scope.monthsList=$scope.mainObj.monthsList:$scope.monthsList=IonicDatepickerService.monthsList,$scope.yearsList=IonicDatepickerService.getYearsList($scope.mainObj.from,$scope.mainObj.to),$scope.dayList=[];var tempDate,disabled;$scope.firstDayEpoch=resetHMSM(new Date(currentDate.getFullYear(),currentDate.getMonth(),firstDay)).getTime(),$scope.lastDayEpoch=resetHMSM(new Date(currentDate.getFullYear(),currentDate.getMonth(),lastDay)).getTime();for(var i=firstDay;i<=lastDay;i++)tempDate=new Date(currentDate.getFullYear(),currentDate.getMonth(),i),disabled=tempDate.getTime()<$scope.fromDate||tempDate.getTime()>$scope.toDate||$scope.mainObj.disableWeekdays.indexOf(tempDate.getDay())>=0,$scope.dayList.push({date:tempDate.getDate(),month:tempDate.getMonth(),year:tempDate.getFullYear(),day:tempDate.getDay(),epoch:tempDate.getTime(),disabled:disabled});var firstDayMonday=$scope.dayList[0].day-$scope.mainObj.mondayFirst;firstDayMonday=firstDayMonday<0?6:firstDayMonday;for(var j=0;j<firstDayMonday;j++)$scope.dayList.unshift({});$scope.rows=[0,7,14,21,28,35],$scope.cols=[0,1,2,3,4,5,6],$scope.data.currentMonth=$scope.mainObj.monthsList[currentDate.getMonth()],$scope.data.currentYear=currentDate.getFullYear(),$scope.data.currentMonthSelected=angular.copy($scope.data.currentMonth),$scope.currentYearSelected=angular.copy($scope.data.currentYear),$scope.numColumns=7}function setInitialObj(ipObj){$scope.mainObj=angular.copy(ipObj),$scope.selctedDateEpoch=resetHMSM($scope.mainObj.inputDate).getTime(),$scope.mainObj.weeksList&&7===$scope.mainObj.weeksList.length?$scope.weeksList=$scope.mainObj.weeksList:$scope.weeksList=["S","M","T","W","T","F","S"],$scope.mainObj.mondayFirst&&$scope.weeksList.push($scope.mainObj.weeksList.shift()),$scope.disableWeekdays=$scope.mainObj.disableWeekdays,refreshDateList($scope.mainObj.inputDate),setDisabledDates($scope.mainObj)}function openModal(){$scope.modal.show()}function closeModal(){$scope.modal.hide()}var provider={},$scope=$rootScope.$new();return $scope.today=resetHMSM(new Date).getTime(),$scope.disabledDates=[],$scope.data={},$scope.prevMonth=function(){1===$scope.currentDate.getMonth()&&$scope.currentDate.setFullYear($scope.currentDate.getFullYear()),$scope.currentDate.setMonth($scope.currentDate.getMonth()-1),$scope.data.currentMonth=$scope.mainObj.monthsList[$scope.currentDate.getMonth()],$scope.data.currentYear=$scope.currentDate.getFullYear(),refreshDateList($scope.currentDate)},$scope.nextMonth=function(){11===$scope.currentDate.getMonth()&&$scope.currentDate.setFullYear($scope.currentDate.getFullYear()),$scope.currentDate.setDate(1),$scope.currentDate.setMonth($scope.currentDate.getMonth()+1),$scope.data.currentMonth=$scope.mainObj.monthsList[$scope.currentDate.getMonth()],$scope.data.currentYear=$scope.currentDate.getFullYear(),refreshDateList($scope.currentDate)},$scope.dateSelected=function(selectedDate){selectedDate&&0!==Object.keys(selectedDate).length&&($scope.selctedDateEpoch=selectedDate.epoch,$scope.mainObj.closeOnSelect&&($scope.mainObj.callback($scope.selctedDateEpoch),"popup"==$scope.mainObj.templateType.toLowerCase()?$scope.popup.close():closeModal()))},$scope.setIonicDatePickerTodayDate=function(){var today=new Date;refreshDateList(new Date),$scope.selctedDateEpoch=resetHMSM(today).getTime(),$scope.mainObj.closeOnSelect&&($scope.mainObj.callback($scope.selctedDateEpoch),closeModal())},$scope.setIonicDatePickerDate=function(){$scope.mainObj.callback($scope.selctedDateEpoch),closeModal()},$scope.monthChanged=function(month){var monthNumber=$scope.monthsList.indexOf(month);$scope.currentDate.setMonth(monthNumber),refreshDateList($scope.currentDate)},$scope.yearChanged=function(year){$scope.currentDate.setFullYear(year),refreshDateList($scope.currentDate)},$ionicModal.fromTemplateUrl("ionic-datepicker-modal.html",{scope:$scope,animation:"slide-in-up"}).then(function(modal){$scope.modal=modal}),$scope.$on("$destroy",function(){$scope.modal.remove()}),$scope.closeIonicDatePickerModal=function(){closeModal()},provider.openDatePicker=function(ipObj){var buttons=[];delete $scope.fromDate,delete $scope.toDate,$scope.mainObj=angular.extend({},config,ipObj),$scope.mainObj.from&&($scope.fromDate=resetHMSM(new Date($scope.mainObj.from)).getTime()),$scope.mainObj.to&&($scope.toDate=resetHMSM(new Date($scope.mainObj.to)).getTime()),ipObj.disableWeekdays&&config.disableWeekdays&&($scope.mainObj.disableWeekdays=ipObj.disableWeekdays.concat(config.disableWeekdays)),setInitialObj($scope.mainObj),$scope.mainObj.closeOnSelect||(buttons=[{text:$scope.mainObj.setLabel,type:"button_set",onTap:function(e){$scope.mainObj.callback($scope.selctedDateEpoch)}}]),$scope.mainObj.showTodayButton&&buttons.push({text:$scope.mainObj.todayLabel,type:"button_today",onTap:function(e){var today=new Date;refreshDateList(new Date),$scope.selctedDateEpoch=resetHMSM(today).getTime(),$scope.mainObj.closeOnSelect||e.preventDefault()}}),buttons.push({text:$scope.mainObj.closeLabel,type:"button_close",onTap:function(e){console.log("ionic-datepicker popup closed.")}}),"popup"==$scope.mainObj.templateType.toLowerCase()?$scope.popup=$ionicPopup.show({templateUrl:"ionic-datepicker-popup.html",scope:$scope,cssClass:"ionic_datepicker_popup",buttons:buttons}):openModal()},provider}]});
angular.module("ionic-datepicker.service",[]).service("IonicDatepickerService",function(){this.monthsList=["January","February","March","April","May","June","July","August","September","October","November","December"],this.getYearsList=function(from,to){var yearsList=[],minYear=1900,maxYear=2100;minYear=from?new Date(from).getFullYear():minYear,maxYear=to?new Date(to).getFullYear():maxYear;for(var i=minYear;i<=maxYear;i++)yearsList.push(i);return yearsList}});
"use strict";angular.module("app.services").factory("NoteService",function($http){return{all:function(){return $http({url:"http://yonotes.apiary-mock.com/notes",method:"GET"})},get:function(id){return $http({url:"http://yonotes.apiary-mock.com/notes/"+id,method:"GET"})}}});
angular.module("app.services").factory("WebService",function(AjaxService){return{getFoodList:function(tsId,date){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/school/getCookbook.do",options.data={tsId:tsId,date:date},AjaxService.ajax(options)},getCourse:function(tsId,pageNumber,pageSize){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/school/getSyllabusList.do",options.data={tsId:tsId,pageNumber:pageNumber,pageSize:pageSize},AjaxService.ajax(options)},delteList:function(tsId,syllabusId){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/school/deleteSyllabus.do",options.data={tsId:tsId,syllabusId:syllabusId},AjaxService.ajax(options)},getLeaveList:function(tsId,pageNumber,pageSize){var options={};return options.type="post",options.useBaseUrl=!0,options.url="/school/getLeave.do",options.data={tsId:tsId,pageNumber:pageNumber,pageSize:pageSize},AjaxService.ajax(options)}}});